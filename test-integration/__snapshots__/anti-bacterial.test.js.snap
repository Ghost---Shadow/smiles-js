// Bun Snapshot v1, https://bun.sh/docs/test/snapshots

exports[`Penicillin G Integration Test parses penicillin g 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "1": [
              {
                "atoms": [
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 5,
          "substitutions": {
            "2": "S",
            "4": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "2": [
              {
                "components": [
                  {
                    "atoms": [
                      "N",
                      "C",
                      "C",
                    ],
                    "attachments": {
                      "2": [
                        {
                          "atoms": [
                            "O",
                          ],
                          "attachments": {},
                          "bonds": [
                            "=",
                          ],
                          "type": "linear",
                        },
                      ],
                    },
                    "bonds": [
                      null,
                      null,
                      null,
                    ],
                    "type": "linear",
                  },
                  {
                    "atoms": "c",
                    "attachments": {},
                    "bonds": [
                      null,
                      null,
                      null,
                      null,
                      null,
                      null,
                    ],
                    "offset": 0,
                    "ringNumber": 3,
                    "size": 6,
                    "substitutions": {},
                    "type": "ring",
                  },
                ],
                "type": "molecule",
              },
            ],
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
          ],
          "offset": 2,
          "ringNumber": 2,
          "size": 4,
          "substitutions": {
            "4": "N",
          },
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {
        "1": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
      ],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Penicillin G Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('C');
export const v2 = Fragment('C1CCCC1');
export const v3 = Fragment('C1SCNC1');
export const v4 = Fragment('C');
export const v5 = v3.attach(1, v4);
export const v6 = Fragment('C2CCC2');
export const v7 = Fragment('C2CCN2');
export const v8 = Fragment('NCC');
export const v9 = Linear(['O'], ['=']);
export const v10 = v8.attach(2, v9);
export const v11 = Fragment('c3ccccc3');
export const v12 = Molecule([v10, v11]);
export const v13 = v7.attach(2, v12);
export const v14 = Linear(['O'], ['=']);
export const v15 = v13.attach(3, v14);
export const v16 = FusedRing({ metadata: { rings: [{ ring: v5, start: 1, end: 19, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'S', rings: [1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 18, depth: 0, value: 'N', rings: [2, 1] }, { position: 19, depth: 0, value: 'C', rings: [1] }] }, { ring: v15, start: 4, end: 18, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 16, depth: 0, value: 'C', rings: [2] }, { position: 18, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v17 = Fragment('CO');
export const v18 = Linear(['O'], ['=']);
export const v19 = v17.attach(1, v18);
export const v20 = Molecule([v1, v16, v19]);"
`;

exports[`Penicillin G Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C']);
export const v2 = Ring({ atoms: 'C', size: 5 });
export const v3 = v2.substitute(2, 'S');
export const v4 = v3.substitute(4, 'N');
export const v5 = Linear(['C']);
export const v6 = v4.attach(1, v5);
export const v7 = Ring({ atoms: 'C', size: 4, ringNumber: 2, offset: 2 });
export const v8 = v7.substitute(4, 'N');
export const v9 = Linear(['N', 'C', 'C']);
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(2, v10);
export const v12 = Ring({ atoms: 'c', size: 6, ringNumber: 3 });
export const v13 = Molecule([v11, v12]);
export const v14 = v8.attach(2, v13);
export const v15 = Linear(['O'], ['=']);
export const v16 = v14.attach(3, v15);
export const v17 = FusedRing({ metadata: { rings: [{ ring: v6, start: 1, end: 19, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'S', rings: [1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 18, depth: 0, value: 'N', rings: [2, 1] }, { position: 19, depth: 0, value: 'C', rings: [1] }] }, { ring: v16, start: 4, end: 18, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 16, depth: 0, value: 'C', rings: [2] }, { position: 18, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v18 = Linear(['C', 'O']);
export const v19 = Linear(['O'], ['=']);
export const v20 = v18.attach(1, v19);
export const v21 = Molecule([v1, v17, v20]);"
`;

exports[`Amoxicillin Integration Test parses amoxicillin 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "1": [
              {
                "atoms": [
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 5,
          "substitutions": {
            "2": "S",
            "4": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "2": [
              {
                "components": [
                  {
                    "atoms": [
                      "N",
                      "C",
                      "C",
                    ],
                    "attachments": {
                      "2": [
                        {
                          "atoms": [
                            "O",
                          ],
                          "attachments": {},
                          "bonds": [
                            "=",
                          ],
                          "type": "linear",
                        },
                      ],
                      "3": [
                        {
                          "atoms": [
                            "N",
                          ],
                          "attachments": {},
                          "bonds": [
                            null,
                          ],
                          "type": "linear",
                        },
                      ],
                    },
                    "bonds": [
                      null,
                      null,
                      null,
                    ],
                    "type": "linear",
                  },
                  {
                    "atoms": "c",
                    "attachments": {
                      "4": [
                        {
                          "atoms": [
                            "O",
                          ],
                          "attachments": {},
                          "bonds": [
                            null,
                          ],
                          "type": "linear",
                        },
                      ],
                    },
                    "bonds": [
                      null,
                      null,
                      null,
                      null,
                      null,
                      null,
                    ],
                    "offset": 0,
                    "ringNumber": 3,
                    "size": 6,
                    "substitutions": {},
                    "type": "ring",
                  },
                ],
                "type": "molecule",
              },
            ],
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
          ],
          "offset": 2,
          "ringNumber": 2,
          "size": 4,
          "substitutions": {
            "4": "N",
          },
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {
        "1": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
      ],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Amoxicillin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('C');
export const v2 = Fragment('C1CCCC1');
export const v3 = Fragment('C1SCNC1');
export const v4 = Fragment('C');
export const v5 = v3.attach(1, v4);
export const v6 = Fragment('C2CCC2');
export const v7 = Fragment('C2CCN2');
export const v8 = Fragment('NCC');
export const v9 = Linear(['O'], ['=']);
export const v10 = v8.attach(2, v9);
export const v11 = Fragment('N');
export const v12 = v10.attach(3, v11);
export const v13 = Fragment('c3ccccc3');
export const v14 = Fragment('O');
export const v15 = v13.attach(4, v14);
export const v16 = Molecule([v12, v15]);
export const v17 = v7.attach(2, v16);
export const v18 = Linear(['O'], ['=']);
export const v19 = v17.attach(3, v18);
export const v20 = FusedRing({ metadata: { rings: [{ ring: v5, start: 1, end: 21, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'S', rings: [1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 20, depth: 0, value: 'N', rings: [2, 1] }, { position: 21, depth: 0, value: 'C', rings: [1] }] }, { ring: v19, start: 4, end: 20, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 18, depth: 0, value: 'C', rings: [2] }, { position: 20, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v21 = Fragment('CO');
export const v22 = Linear(['O'], ['=']);
export const v23 = v21.attach(1, v22);
export const v24 = Molecule([v1, v20, v23]);"
`;

exports[`Amoxicillin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C']);
export const v2 = Ring({ atoms: 'C', size: 5 });
export const v3 = v2.substitute(2, 'S');
export const v4 = v3.substitute(4, 'N');
export const v5 = Linear(['C']);
export const v6 = v4.attach(1, v5);
export const v7 = Ring({ atoms: 'C', size: 4, ringNumber: 2, offset: 2 });
export const v8 = v7.substitute(4, 'N');
export const v9 = Linear(['N', 'C', 'C']);
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(2, v10);
export const v12 = Linear(['N']);
export const v13 = v11.attach(3, v12);
export const v14 = Ring({ atoms: 'c', size: 6, ringNumber: 3 });
export const v15 = Linear(['O']);
export const v16 = v14.attach(4, v15);
export const v17 = Molecule([v13, v16]);
export const v18 = v8.attach(2, v17);
export const v19 = Linear(['O'], ['=']);
export const v20 = v18.attach(3, v19);
export const v21 = FusedRing({ metadata: { rings: [{ ring: v6, start: 1, end: 21, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'S', rings: [1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 20, depth: 0, value: 'N', rings: [2, 1] }, { position: 21, depth: 0, value: 'C', rings: [1] }] }, { ring: v20, start: 4, end: 20, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 18, depth: 0, value: 'C', rings: [2] }, { position: 20, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v22 = Linear(['C', 'O']);
export const v23 = Linear(['O'], ['=']);
export const v24 = v22.attach(1, v23);
export const v25 = Molecule([v1, v21, v24]);"
`;

exports[`Ampicillin Integration Test parses ampicillin 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "1": [
              {
                "atoms": [
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 5,
          "substitutions": {
            "2": "S",
            "4": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "2": [
              {
                "components": [
                  {
                    "atoms": [
                      "N",
                      "C",
                      "C",
                    ],
                    "attachments": {
                      "2": [
                        {
                          "atoms": [
                            "O",
                          ],
                          "attachments": {},
                          "bonds": [
                            "=",
                          ],
                          "type": "linear",
                        },
                      ],
                      "3": [
                        {
                          "atoms": [
                            "N",
                          ],
                          "attachments": {},
                          "bonds": [
                            null,
                          ],
                          "type": "linear",
                        },
                      ],
                    },
                    "bonds": [
                      null,
                      null,
                      null,
                    ],
                    "type": "linear",
                  },
                  {
                    "atoms": "c",
                    "attachments": {},
                    "bonds": [
                      null,
                      null,
                      null,
                      null,
                      null,
                      null,
                    ],
                    "offset": 0,
                    "ringNumber": 3,
                    "size": 6,
                    "substitutions": {},
                    "type": "ring",
                  },
                ],
                "type": "molecule",
              },
            ],
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
          ],
          "offset": 2,
          "ringNumber": 2,
          "size": 4,
          "substitutions": {
            "4": "N",
          },
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {
        "1": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
      ],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Ampicillin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('C');
export const v2 = Fragment('C1CCCC1');
export const v3 = Fragment('C1SCNC1');
export const v4 = Fragment('C');
export const v5 = v3.attach(1, v4);
export const v6 = Fragment('C2CCC2');
export const v7 = Fragment('C2CCN2');
export const v8 = Fragment('NCC');
export const v9 = Linear(['O'], ['=']);
export const v10 = v8.attach(2, v9);
export const v11 = Fragment('N');
export const v12 = v10.attach(3, v11);
export const v13 = Fragment('c3ccccc3');
export const v14 = Molecule([v12, v13]);
export const v15 = v7.attach(2, v14);
export const v16 = Linear(['O'], ['=']);
export const v17 = v15.attach(3, v16);
export const v18 = FusedRing({ metadata: { rings: [{ ring: v5, start: 1, end: 20, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'S', rings: [1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 19, depth: 0, value: 'N', rings: [2, 1] }, { position: 20, depth: 0, value: 'C', rings: [1] }] }, { ring: v17, start: 4, end: 19, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 17, depth: 0, value: 'C', rings: [2] }, { position: 19, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v19 = Fragment('CO');
export const v20 = Linear(['O'], ['=']);
export const v21 = v19.attach(1, v20);
export const v22 = Molecule([v1, v18, v21]);"
`;

exports[`Ampicillin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C']);
export const v2 = Ring({ atoms: 'C', size: 5 });
export const v3 = v2.substitute(2, 'S');
export const v4 = v3.substitute(4, 'N');
export const v5 = Linear(['C']);
export const v6 = v4.attach(1, v5);
export const v7 = Ring({ atoms: 'C', size: 4, ringNumber: 2, offset: 2 });
export const v8 = v7.substitute(4, 'N');
export const v9 = Linear(['N', 'C', 'C']);
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(2, v10);
export const v12 = Linear(['N']);
export const v13 = v11.attach(3, v12);
export const v14 = Ring({ atoms: 'c', size: 6, ringNumber: 3 });
export const v15 = Molecule([v13, v14]);
export const v16 = v8.attach(2, v15);
export const v17 = Linear(['O'], ['=']);
export const v18 = v16.attach(3, v17);
export const v19 = FusedRing({ metadata: { rings: [{ ring: v6, start: 1, end: 20, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'S', rings: [1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 19, depth: 0, value: 'N', rings: [2, 1] }, { position: 20, depth: 0, value: 'C', rings: [1] }] }, { ring: v18, start: 4, end: 19, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 17, depth: 0, value: 'C', rings: [2] }, { position: 19, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v20 = Linear(['C', 'O']);
export const v21 = Linear(['O'], ['=']);
export const v22 = v20.attach(1, v21);
export const v23 = Molecule([v1, v19, v22]);"
`;

exports[`Cephalexin Integration Test parses cephalexin 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "1": [
              {
                "atoms": [
                  "C",
                  "O",
                ],
                "attachments": {
                  "1": [
                    {
                      "atoms": [
                        "O",
                      ],
                      "attachments": {},
                      "bonds": [
                        "=",
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 5,
          "substitutions": {
            "2": "S",
            "4": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
          ],
          "offset": 2,
          "ringNumber": 2,
          "size": 4,
          "substitutions": {
            "4": "N",
          },
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "N",
        "C",
        "C",
      ],
      "attachments": {
        "2": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
        "3": [
          {
            "atoms": [
              "N",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
      ],
      "type": "linear",
    },
    {
      "atoms": "c",
      "attachments": {},
      "bonds": [
        null,
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 6,
      "substitutions": {},
      "type": "ring",
    },
  ],
  "type": "molecule",
}
`;

exports[`Cephalexin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('C');
export const v2 = Fragment('C1CCCC1');
export const v3 = Fragment('C1SCNC1');
export const v4 = Fragment('CO');
export const v5 = Linear(['O'], ['=']);
export const v6 = v4.attach(1, v5);
export const v7 = v3.attach(1, v6);
export const v8 = Fragment('C2CCC2');
export const v9 = Fragment('C2CCN2');
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(3, v10);
export const v12 = FusedRing({ metadata: { rings: [{ ring: v7, start: 1, end: 11, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 5, depth: 0, value: 'S', rings: [1] }, { position: 6, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 10, depth: 0, value: 'N', rings: [2, 1] }, { position: 11, depth: 0, value: 'C', rings: [1] }] }, { ring: v11, start: 6, end: 10, atoms: [{ position: 6, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 7, depth: 0, value: 'C', rings: [2] }, { position: 8, depth: 0, value: 'C', rings: [2] }, { position: 10, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v13 = Fragment('NCC');
export const v14 = Linear(['O'], ['=']);
export const v15 = v13.attach(2, v14);
export const v16 = Fragment('N');
export const v17 = v15.attach(3, v16);
export const v18 = Fragment('c1ccccc1');
export const v19 = Molecule([v1, v12, v17, v18]);"
`;

exports[`Cephalexin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C']);
export const v2 = Ring({ atoms: 'C', size: 5 });
export const v3 = v2.substitute(2, 'S');
export const v4 = v3.substitute(4, 'N');
export const v5 = Linear(['C', 'O']);
export const v6 = Linear(['O'], ['=']);
export const v7 = v5.attach(1, v6);
export const v8 = v4.attach(1, v7);
export const v9 = Ring({ atoms: 'C', size: 4, ringNumber: 2, offset: 2 });
export const v10 = v9.substitute(4, 'N');
export const v11 = Linear(['O'], ['=']);
export const v12 = v10.attach(3, v11);
export const v13 = FusedRing({ metadata: { rings: [{ ring: v8, start: 1, end: 11, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 5, depth: 0, value: 'S', rings: [1] }, { position: 6, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 10, depth: 0, value: 'N', rings: [2, 1] }, { position: 11, depth: 0, value: 'C', rings: [1] }] }, { ring: v12, start: 6, end: 10, atoms: [{ position: 6, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 7, depth: 0, value: 'C', rings: [2] }, { position: 8, depth: 0, value: 'C', rings: [2] }, { position: 10, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v14 = Linear(['N', 'C', 'C']);
export const v15 = Linear(['O'], ['=']);
export const v16 = v14.attach(2, v15);
export const v17 = Linear(['N']);
export const v18 = v16.attach(3, v17);
export const v19 = Ring({ atoms: 'c', size: 6 });
export const v20 = Molecule([v1, v13, v18, v19]);"
`;

exports[`Ceftriaxone Integration Test parses ceftriaxone 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {},
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "c",
          "attachments": {
            "5": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            "=",
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 6,
          "substitutions": {
            "1": "C",
            "2": "N",
            "5": "C",
            "6": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {},
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 2,
          "ringNumber": 2,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": "c",
      "attachments": {
        "4": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 5,
      "substitutions": {
        "2": "n",
        "3": "s",
        "5": "[nH]",
      },
      "type": "ring",
    },
  ],
  "type": "molecule",
}
`;

exports[`Ceftriaxone Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CO');
export const v2 = Fragment('c1=cc(ccc1)');
export const v3 = Fragment('C1=Nc(cCN1)');
export const v4 = Linear(['O'], ['=']);
export const v5 = v3.attach(5, v4, { sibling: true });
export const v6 = Fragment('c2ccc(cc2)');
export const v7 = FusedRing({ metadata: { rings: [{ ring: v5, start: 2, end: 12, atoms: [{ position: 2, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'N', bond: '=', rings: [1] }, { position: 4, depth: 0, value: 'c', rings: [2, 2, 1] }, { position: 9, depth: 1, value: 'c', rings: [2, 1], branchId: 11 }, { position: 10, depth: 1, value: 'C', rings: [1], branchId: 11 }, { position: 12, depth: 1, value: 'N', rings: [1], branchId: 11 }] }, { ring: v6, start: 4, end: 9, atoms: [{ position: 4, depth: 0, value: 'c', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'c', rings: [2] }, { position: 6, depth: 0, value: 'c', rings: [2] }, { position: 7, depth: 0, value: 'c', rings: [2] }, { position: 8, depth: 1, value: 'c', rings: [2], branchId: 11 }, { position: 9, depth: 1, value: 'c', rings: [2, 1], branchId: 11 }] }] } });
export const v8 = Fragment('c1cccc1');
export const v9 = Fragment('c1nsc[nH]1');
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(4, v10);
export const v12 = Molecule([v1, v7, v11]);"
`;

exports[`Ceftriaxone Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'O']);
export const v2 = Ring({ atoms: 'c', size: 6, bonds: ['=', null, null, null, null, null], branchDepths: [0, 0, 0, 1, 1, 1] });
export const v3 = v2.substitute(1, 'C');
export const v4 = v3.substitute(2, 'N');
export const v5 = v4.substitute(5, 'C');
export const v6 = v5.substitute(6, 'N');
export const v7 = Linear(['O'], ['=']);
export const v8 = v6.attach(5, v7, { sibling: true });
export const v9 = Ring({ atoms: 'c', size: 6, ringNumber: 2, offset: 2, branchDepths: [0, 0, 0, 0, 1, 1] });
export const v10 = FusedRing({ metadata: { rings: [{ ring: v8, start: 2, end: 12, atoms: [{ position: 2, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'N', bond: '=', rings: [1] }, { position: 4, depth: 0, value: 'c', rings: [2, 2, 1] }, { position: 9, depth: 1, value: 'c', rings: [2, 1], branchId: 11 }, { position: 10, depth: 1, value: 'C', rings: [1], branchId: 11 }, { position: 12, depth: 1, value: 'N', rings: [1], branchId: 11 }] }, { ring: v9, start: 4, end: 9, atoms: [{ position: 4, depth: 0, value: 'c', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'c', rings: [2] }, { position: 6, depth: 0, value: 'c', rings: [2] }, { position: 7, depth: 0, value: 'c', rings: [2] }, { position: 8, depth: 1, value: 'c', rings: [2], branchId: 11 }, { position: 9, depth: 1, value: 'c', rings: [2, 1], branchId: 11 }] }] } });
export const v11 = Ring({ atoms: 'c', size: 5 });
export const v12 = v11.substitute(2, 'n');
export const v13 = v12.substitute(3, 's');
export const v14 = v13.substitute(5, '[nH]');
export const v15 = Linear(['O'], ['=']);
export const v16 = v14.attach(4, v15);
export const v17 = Molecule([v1, v10, v16]);"
`;

exports[`Ciprofloxacin Integration Test parses ciprofloxacin 1`] = `
{
  "components": [
    {
      "atoms": [
        "O",
        "C",
      ],
      "attachments": {
        "2": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        "=",
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "c",
          "attachments": {
            "3": [
              {
                "atoms": "C",
                "attachments": {},
                "bonds": [
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 2,
                "size": 3,
                "substitutions": {},
                "type": "ring",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 6,
          "substitutions": {
            "3": "n",
          },
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {
            "3": [
              {
                "atoms": "C",
                "attachments": {},
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 3,
                "size": 6,
                "substitutions": {
                  "1": "N",
                  "4": "N",
                },
                "type": "ring",
              },
            ],
            "4": [
              {
                "atoms": [
                  "F",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 3,
          "ringNumber": 2,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "O",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Ciprofloxacin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C'], ['=']);
export const v2 = Fragment('O');
export const v3 = v1.attach(2, v2);
export const v4 = Fragment('c1ccccc1');
export const v5 = Fragment('c1cnccc1');
export const v6 = Fragment('C2CC2');
export const v7 = v5.attach(3, v6);
export const v8 = Fragment('c2ccccc2');
export const v9 = Fragment('C3CCCCC3');
export const v10 = Fragment('N3CCNCC3');
export const v11 = v8.attach(3, v10);
export const v12 = Fragment('F');
export const v13 = v11.attach(4, v12);
export const v14 = FusedRing({ metadata: { rings: [{ ring: v7, start: 3, end: 22, atoms: [{ position: 3, depth: 0, value: 'c', rings: [1, 1] }, { position: 4, depth: 0, value: 'c', rings: [1] }, { position: 5, depth: 0, value: 'n', rings: [1] }, { position: 9, depth: 0, value: 'c', rings: [2, 2, 1] }, { position: 21, depth: 0, value: 'c', rings: [2, 1] }, { position: 22, depth: 0, value: 'c', rings: [1] }] }, { ring: v13, start: 9, end: 21, atoms: [{ position: 9, depth: 0, value: 'c', rings: [2, 2, 1] }, { position: 10, depth: 0, value: 'c', rings: [2] }, { position: 11, depth: 0, value: 'c', rings: [2] }, { position: 18, depth: 0, value: 'c', rings: [2] }, { position: 20, depth: 0, value: 'c', rings: [2] }, { position: 21, depth: 0, value: 'c', rings: [2, 1] }] }] } });
export const v15 = Linear(['O'], [], {}, '=');
export const v16 = Molecule([v3, v14, v15]);"
`;

exports[`Ciprofloxacin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C'], ['=']);
export const v2 = Linear(['O']);
export const v3 = v1.attach(2, v2);
export const v4 = Ring({ atoms: 'c', size: 6 });
export const v5 = v4.substitute(3, 'n');
export const v6 = Ring({ atoms: 'C', size: 3, ringNumber: 2 });
export const v7 = v5.attach(3, v6);
export const v8 = Ring({ atoms: 'c', size: 6, ringNumber: 2, offset: 3 });
export const v9 = Ring({ atoms: 'C', size: 6, ringNumber: 3 });
export const v10 = v9.substitute(1, 'N');
export const v11 = v10.substitute(4, 'N');
export const v12 = v8.attach(3, v11);
export const v13 = Linear(['F']);
export const v14 = v12.attach(4, v13);
export const v15 = FusedRing({ metadata: { rings: [{ ring: v7, start: 3, end: 22, atoms: [{ position: 3, depth: 0, value: 'c', rings: [1, 1] }, { position: 4, depth: 0, value: 'c', rings: [1] }, { position: 5, depth: 0, value: 'n', rings: [1] }, { position: 9, depth: 0, value: 'c', rings: [2, 2, 1] }, { position: 21, depth: 0, value: 'c', rings: [2, 1] }, { position: 22, depth: 0, value: 'c', rings: [1] }] }, { ring: v14, start: 9, end: 21, atoms: [{ position: 9, depth: 0, value: 'c', rings: [2, 2, 1] }, { position: 10, depth: 0, value: 'c', rings: [2] }, { position: 11, depth: 0, value: 'c', rings: [2] }, { position: 18, depth: 0, value: 'c', rings: [2] }, { position: 20, depth: 0, value: 'c', rings: [2] }, { position: 21, depth: 0, value: 'c', rings: [2, 1] }] }] } });
export const v16 = Linear(['O'], [], {}, '=');
export const v17 = Molecule([v3, v15, v16]);"
`;

exports[`Levofloxacin Integration Test parses levofloxacin 1`] = `
{
  "components": [
    {
      "atoms": [
        "O",
        "C",
      ],
      "attachments": {
        "2": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        "=",
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "c",
          "attachments": {
            "5": [
              {
                "atoms": "C",
                "attachments": {
                  "4": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 2,
                "size": 6,
                "substitutions": {
                  "1": "N",
                  "4": "N",
                },
                "type": "ring",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 6,
          "substitutions": {
            "3": "n",
          },
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {
            "2": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "3": [
              {
                "atoms": [
                  "C",
                  "F",
                ],
                "attachments": {
                  "1": [
                    {
                      "atoms": [
                        "F",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                    {
                      "atoms": [
                        "F",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 2,
          "ringNumber": 2,
          "size": 5,
          "substitutions": {
            "1": "n",
          },
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "F",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Levofloxacin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C'], ['=']);
export const v2 = Fragment('O');
export const v3 = v1.attach(2, v2);
export const v4 = Fragment('c1ccccc1');
export const v5 = Fragment('c1cnccc1');
export const v6 = Fragment('C2CCCCC2');
export const v7 = Fragment('N2CCNCC2');
export const v8 = Fragment('C');
export const v9 = v7.attach(4, v8);
export const v10 = v5.attach(5, v9);
export const v11 = Fragment('c2cccc2');
export const v12 = Fragment('n2cccc2');
export const v13 = Linear(['O'], ['=']);
export const v14 = v12.attach(2, v13);
export const v15 = Fragment('CF');
export const v16 = Fragment('F');
export const v17 = v15.attach(1, v16);
export const v18 = Fragment('F');
export const v19 = v17.attach(1, v18);
export const v20 = v14.attach(3, v19);
export const v21 = FusedRing({ metadata: { rings: [{ ring: v10, start: 3, end: 23, atoms: [{ position: 3, depth: 0, value: 'c', rings: [1, 1] }, { position: 4, depth: 0, value: 'c', rings: [1] }, { position: 5, depth: 0, value: 'n', rings: [2, 2, 1] }, { position: 14, depth: 0, value: 'c', rings: [2, 1] }, { position: 15, depth: 0, value: 'c', rings: [1] }, { position: 23, depth: 0, value: 'c', rings: [1] }] }, { ring: v20, start: 5, end: 14, atoms: [{ position: 5, depth: 0, value: 'n', rings: [2, 2, 1] }, { position: 6, depth: 0, value: 'c', rings: [2] }, { position: 8, depth: 0, value: 'c', rings: [2] }, { position: 13, depth: 0, value: 'c', rings: [2] }, { position: 14, depth: 0, value: 'c', rings: [2, 1] }] }] } });
export const v22 = Fragment('F');
export const v23 = Molecule([v3, v21, v22]);"
`;

exports[`Levofloxacin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C'], ['=']);
export const v2 = Linear(['O']);
export const v3 = v1.attach(2, v2);
export const v4 = Ring({ atoms: 'c', size: 6 });
export const v5 = v4.substitute(3, 'n');
export const v6 = Ring({ atoms: 'C', size: 6, ringNumber: 2 });
export const v7 = v6.substitute(1, 'N');
export const v8 = v7.substitute(4, 'N');
export const v9 = Linear(['C']);
export const v10 = v8.attach(4, v9);
export const v11 = v5.attach(5, v10);
export const v12 = Ring({ atoms: 'c', size: 5, ringNumber: 2, offset: 2 });
export const v13 = v12.substitute(1, 'n');
export const v14 = Linear(['O'], ['=']);
export const v15 = v13.attach(2, v14);
export const v16 = Linear(['C', 'F']);
export const v17 = Linear(['F']);
export const v18 = v16.attach(1, v17);
export const v19 = Linear(['F']);
export const v20 = v18.attach(1, v19);
export const v21 = v15.attach(3, v20);
export const v22 = FusedRing({ metadata: { rings: [{ ring: v11, start: 3, end: 23, atoms: [{ position: 3, depth: 0, value: 'c', rings: [1, 1] }, { position: 4, depth: 0, value: 'c', rings: [1] }, { position: 5, depth: 0, value: 'n', rings: [2, 2, 1] }, { position: 14, depth: 0, value: 'c', rings: [2, 1] }, { position: 15, depth: 0, value: 'c', rings: [1] }, { position: 23, depth: 0, value: 'c', rings: [1] }] }, { ring: v21, start: 5, end: 14, atoms: [{ position: 5, depth: 0, value: 'n', rings: [2, 2, 1] }, { position: 6, depth: 0, value: 'c', rings: [2] }, { position: 8, depth: 0, value: 'c', rings: [2] }, { position: 13, depth: 0, value: 'c', rings: [2] }, { position: 14, depth: 0, value: 'c', rings: [2, 1] }] }] } });
export const v23 = Linear(['F']);
export const v24 = Molecule([v3, v22, v23]);"
`;

exports[`Tetracycline Integration Test parses tetracycline 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "N",
      ],
      "attachments": {
        "2": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "4": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            "=",
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 5,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "4": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "5": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 1,
          "ringNumber": 2,
          "size": 5,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "5": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            "=",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 3,
          "size": 9,
          "substitutions": {
            "1": "C",
            "2": "C",
            "3": "C",
          },
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {
            "2": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 4,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {
        "1": [
          {
            "atoms": [
              "N",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        "=",
      ],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Tetracycline Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CN');
export const v2 = Fragment('C');
export const v3 = v1.attach(2, v2);
export const v4 = Fragment('C1CCC=C1');
export const v5 = Fragment('O');
export const v6 = v4.attach(3, v5);
export const v7 = Fragment('O');
export const v8 = v6.attach(4, v7);
export const v9 = Fragment('C2CCCC2');
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(4, v10);
export const v12 = Fragment('O');
export const v13 = v11.attach(5, v12);
export const v14 = Fragment('c3c(=ccccccc3)');
export const v15 = Fragment('C3C(=Ccccccc3)');
export const v16 = Fragment('O');
export const v17 = v15.attach(3, v16, { sibling: true });
export const v18 = Fragment('O');
export const v19 = v17.attach(5, v18, { sibling: true });
export const v20 = Fragment('c4ccccc4');
export const v21 = Fragment('O');
export const v22 = v20.attach(2, v21);
export const v23 = FusedRing({ metadata: { rings: [{ ring: v8, start: 3, end: 23, atoms: [{ position: 3, depth: 0, value: 'C', rings: [1, 1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 19, depth: 0, value: 'C', rings: [2, 1] }, { position: 21, depth: 0, value: 'C', rings: [1] }, { position: 23, depth: 0, value: 'C', bond: '=', rings: [1] }] }, { ring: v13, start: 4, end: 19, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 6, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 17, depth: 0, value: 'C', rings: [2] }, { position: 19, depth: 0, value: 'C', rings: [2, 1] }] }, { ring: v19, start: 6, end: 16, atoms: [{ position: 6, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 7, depth: 0, value: 'C', rings: [3] }, { position: 8, depth: 1, value: 'C', bond: '=', rings: [3], branchId: 13 }, { position: 10, depth: 1, value: 'c', rings: [4, 4, 3], branchId: 13 }, { position: 11, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 13, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 14, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 15, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 16, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }] }, { ring: v22, start: 10, end: 16, atoms: [{ position: 10, depth: 1, value: 'c', rings: [4, 4, 3], branchId: 13 }, { position: 11, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 13, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 14, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 15, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 16, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }] }] } });
export const v24 = Linear(['C', 'O'], ['=']);
export const v25 = Fragment('N');
export const v26 = v24.attach(1, v25);
export const v27 = Molecule([v3, v23, v26]);"
`;

exports[`Tetracycline Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'N']);
export const v2 = Linear(['C']);
export const v3 = v1.attach(2, v2);
export const v4 = Ring({ atoms: 'C', size: 5, bonds: [null, null, null, '=', null] });
export const v5 = Linear(['O']);
export const v6 = v4.attach(3, v5);
export const v7 = Linear(['O']);
export const v8 = v6.attach(4, v7);
export const v9 = Ring({ atoms: 'C', size: 5, ringNumber: 2, offset: 1 });
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(4, v10);
export const v12 = Linear(['O']);
export const v13 = v11.attach(5, v12);
export const v14 = Ring({ atoms: 'c', size: 9, ringNumber: 3, bonds: [null, '=', null, null, null, null, null, null, null], branchDepths: [0, 0, 1, 1, 1, 1, 1, 1, 1] });
export const v15 = v14.substitute(1, 'C');
export const v16 = v15.substitute(2, 'C');
export const v17 = v16.substitute(3, 'C');
export const v18 = Linear(['O']);
export const v19 = v17.attach(3, v18, { sibling: true });
export const v20 = Linear(['O']);
export const v21 = v19.attach(5, v20, { sibling: true });
export const v22 = Ring({ atoms: 'c', size: 6, ringNumber: 4 });
export const v23 = Linear(['O']);
export const v24 = v22.attach(2, v23);
export const v25 = FusedRing({ metadata: { rings: [{ ring: v8, start: 3, end: 23, atoms: [{ position: 3, depth: 0, value: 'C', rings: [1, 1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 19, depth: 0, value: 'C', rings: [2, 1] }, { position: 21, depth: 0, value: 'C', rings: [1] }, { position: 23, depth: 0, value: 'C', bond: '=', rings: [1] }] }, { ring: v13, start: 4, end: 19, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 6, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 17, depth: 0, value: 'C', rings: [2] }, { position: 19, depth: 0, value: 'C', rings: [2, 1] }] }, { ring: v21, start: 6, end: 16, atoms: [{ position: 6, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 7, depth: 0, value: 'C', rings: [3] }, { position: 8, depth: 1, value: 'C', bond: '=', rings: [3], branchId: 13 }, { position: 10, depth: 1, value: 'c', rings: [4, 4, 3], branchId: 13 }, { position: 11, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 13, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 14, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 15, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 16, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }] }, { ring: v24, start: 10, end: 16, atoms: [{ position: 10, depth: 1, value: 'c', rings: [4, 4, 3], branchId: 13 }, { position: 11, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 13, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 14, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 15, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 16, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }] }] } });
export const v26 = Linear(['C', 'O'], ['=']);
export const v27 = Linear(['N']);
export const v28 = v26.attach(1, v27);
export const v29 = Molecule([v3, v25, v28]);"
`;

exports[`Doxycycline Integration Test parses doxycycline 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "N",
      ],
      "attachments": {
        "2": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "4": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 5,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "4": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "5": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 1,
          "ringNumber": 2,
          "size": 5,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "5": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            "=",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 3,
          "size": 9,
          "substitutions": {
            "1": "C",
            "2": "C",
            "3": "C",
          },
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {
            "2": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 4,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "O",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Doxycycline Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CN');
export const v2 = Fragment('C');
export const v3 = v1.attach(2, v2);
export const v4 = Fragment('C1CCCC1');
export const v5 = Fragment('O');
export const v6 = v4.attach(3, v5);
export const v7 = Linear(['O'], ['=']);
export const v8 = v6.attach(4, v7);
export const v9 = Fragment('C2CCCC2');
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(4, v10);
export const v12 = Fragment('O');
export const v13 = v11.attach(5, v12);
export const v14 = Fragment('c3c(=ccccccc3)');
export const v15 = Fragment('C3C(=Ccccccc3)');
export const v16 = Fragment('O');
export const v17 = v15.attach(3, v16, { sibling: true });
export const v18 = Fragment('O');
export const v19 = v17.attach(5, v18, { sibling: true });
export const v20 = Fragment('c4ccccc4');
export const v21 = Fragment('O');
export const v22 = v20.attach(2, v21);
export const v23 = FusedRing({ metadata: { rings: [{ ring: v8, start: 3, end: 23, atoms: [{ position: 3, depth: 0, value: 'C', rings: [1, 1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 19, depth: 0, value: 'C', rings: [2, 1] }, { position: 21, depth: 0, value: 'C', rings: [1] }, { position: 23, depth: 0, value: 'C', rings: [1] }] }, { ring: v13, start: 4, end: 19, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 6, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 17, depth: 0, value: 'C', rings: [2] }, { position: 19, depth: 0, value: 'C', rings: [2, 1] }] }, { ring: v19, start: 6, end: 16, atoms: [{ position: 6, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 7, depth: 0, value: 'C', rings: [3] }, { position: 8, depth: 1, value: 'C', bond: '=', rings: [3], branchId: 13 }, { position: 10, depth: 1, value: 'c', rings: [4, 4, 3], branchId: 13 }, { position: 11, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 13, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 14, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 15, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 16, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }] }, { ring: v22, start: 10, end: 16, atoms: [{ position: 10, depth: 1, value: 'c', rings: [4, 4, 3], branchId: 13 }, { position: 11, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 13, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 14, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 15, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 16, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }] }] } });
export const v24 = Fragment('O');
export const v25 = Molecule([v3, v23, v24]);"
`;

exports[`Doxycycline Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'N']);
export const v2 = Linear(['C']);
export const v3 = v1.attach(2, v2);
export const v4 = Ring({ atoms: 'C', size: 5 });
export const v5 = Linear(['O']);
export const v6 = v4.attach(3, v5);
export const v7 = Linear(['O'], ['=']);
export const v8 = v6.attach(4, v7);
export const v9 = Ring({ atoms: 'C', size: 5, ringNumber: 2, offset: 1 });
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(4, v10);
export const v12 = Linear(['O']);
export const v13 = v11.attach(5, v12);
export const v14 = Ring({ atoms: 'c', size: 9, ringNumber: 3, bonds: [null, '=', null, null, null, null, null, null, null], branchDepths: [0, 0, 1, 1, 1, 1, 1, 1, 1] });
export const v15 = v14.substitute(1, 'C');
export const v16 = v15.substitute(2, 'C');
export const v17 = v16.substitute(3, 'C');
export const v18 = Linear(['O']);
export const v19 = v17.attach(3, v18, { sibling: true });
export const v20 = Linear(['O']);
export const v21 = v19.attach(5, v20, { sibling: true });
export const v22 = Ring({ atoms: 'c', size: 6, ringNumber: 4 });
export const v23 = Linear(['O']);
export const v24 = v22.attach(2, v23);
export const v25 = FusedRing({ metadata: { rings: [{ ring: v8, start: 3, end: 23, atoms: [{ position: 3, depth: 0, value: 'C', rings: [1, 1] }, { position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 19, depth: 0, value: 'C', rings: [2, 1] }, { position: 21, depth: 0, value: 'C', rings: [1] }, { position: 23, depth: 0, value: 'C', rings: [1] }] }, { ring: v13, start: 4, end: 19, atoms: [{ position: 4, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 6, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 17, depth: 0, value: 'C', rings: [2] }, { position: 19, depth: 0, value: 'C', rings: [2, 1] }] }, { ring: v21, start: 6, end: 16, atoms: [{ position: 6, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 7, depth: 0, value: 'C', rings: [3] }, { position: 8, depth: 1, value: 'C', bond: '=', rings: [3], branchId: 13 }, { position: 10, depth: 1, value: 'c', rings: [4, 4, 3], branchId: 13 }, { position: 11, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 13, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 14, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 15, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 16, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }] }, { ring: v24, start: 10, end: 16, atoms: [{ position: 10, depth: 1, value: 'c', rings: [4, 4, 3], branchId: 13 }, { position: 11, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 13, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 14, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 15, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }, { position: 16, depth: 1, value: 'c', rings: [4, 3], branchId: 13 }] }] } });
export const v26 = Linear(['O']);
export const v27 = Molecule([v3, v25, v26]);"
`;

exports[`Minocycline Integration Test parses minocycline 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "N",
      ],
      "attachments": {
        "2": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "c",
          "attachments": {},
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            "=",
            null,
            "=",
            null,
          ],
          "offset": 3,
          "ringNumber": 2,
          "size": 6,
          "substitutions": {
            "1": "c",
            "2": "c",
          },
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "2": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "4": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 5,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "2": [
              {
                "atoms": [
                  "N",
                  "C",
                ],
                "attachments": {
                  "1": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                ],
                "type": "linear",
              },
            ],
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "4": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "5": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 3,
          "size": 5,
          "substitutions": {},
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "O",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Minocycline Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CN');
export const v2 = Fragment('C');
export const v3 = v1.attach(2, v2);
export const v4 = Fragment('c1cccc(c1)');
export const v5 = Fragment('C2CC=CC=C2');
export const v6 = Fragment('c2cC=CC=C2');
export const v7 = Fragment('O');
export const v8 = v6.attach(3, v7);
export const v9 = Ring({ atoms: 'C', size: 5, leadingBond: '=' });
export const v10 = Linear(['O'], ['=']);
export const v11 = v9.attach(2, v10);
export const v12 = Fragment('O');
export const v13 = v11.attach(4, v12);
export const v14 = Fragment('C3CCCC3');
export const v15 = Fragment('NC');
export const v16 = Fragment('C');
export const v17 = v15.attach(1, v16);
export const v18 = v14.attach(2, v17);
export const v19 = Fragment('O');
export const v20 = v18.attach(3, v19);
export const v21 = Linear(['O'], ['=']);
export const v22 = v20.attach(4, v21);
export const v23 = Fragment('O');
export const v24 = v22.attach(5, v23);
export const v25 = FusedRing({ metadata: { rings: [{ ring: v4, start: 3, end: 8, atoms: [{ position: 3, depth: 0, value: 'c', rings: [1, 1] }, { position: 4, depth: 0, value: 'c', rings: [1] }, { position: 5, depth: 0, value: 'c', rings: [1] }, { position: 6, depth: 0, value: 'c', rings: [2, 1, 2] }, { position: 7, depth: 0, value: 'c', rings: [1, 2] }, { position: 8, depth: 1, value: 'c', rings: [1], branchId: 12 }] }, { ring: v8, start: 6, end: 26, atoms: [{ position: 6, depth: 0, value: 'c', rings: [2, 1, 2] }, { position: 7, depth: 0, value: 'c', rings: [1, 2] }, { position: 9, depth: 0, value: 'C', rings: [2] }, { position: 11, depth: 0, value: 'C', bond: '=', rings: [1, 1, 2] }, { position: 25, depth: 0, value: 'C', rings: [1, 2] }, { position: 26, depth: 0, value: 'C', bond: '=', rings: [2] }] }, { ring: v13, start: 11, end: 25, atoms: [{ position: 11, depth: 0, value: 'C', bond: '=', rings: [1, 1, 2] }, { position: 12, depth: 0, value: 'C', rings: [1] }, { position: 14, depth: 0, value: 'C', rings: [3, 3, 1] }, { position: 23, depth: 0, value: 'C', rings: [3, 1] }, { position: 25, depth: 0, value: 'C', rings: [1, 2] }] }, { ring: v24, start: 14, end: 23, atoms: [{ position: 14, depth: 0, value: 'C', rings: [3, 3, 1] }, { position: 15, depth: 0, value: 'C', rings: [3] }, { position: 19, depth: 0, value: 'C', rings: [3] }, { position: 21, depth: 0, value: 'C', rings: [3] }, { position: 23, depth: 0, value: 'C', rings: [3, 1] }] }] } });
export const v26 = Fragment('O');
export const v27 = Molecule([v3, v25, v26]);"
`;

exports[`Minocycline Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'N']);
export const v2 = Linear(['C']);
export const v3 = v1.attach(2, v2);
export const v4 = Ring({ atoms: 'c', size: 6, branchDepths: [0, 0, 0, 0, 0, 1] });
export const v5 = Ring({ atoms: 'C', size: 6, ringNumber: 2, offset: 3, bonds: [null, null, '=', null, '=', null] });
export const v6 = v5.substitute(1, 'c');
export const v7 = v6.substitute(2, 'c');
export const v8 = Linear(['O']);
export const v9 = v7.attach(3, v8);
export const v10 = Ring({ atoms: 'C', size: 5, leadingBond: '=' });
export const v11 = Linear(['O'], ['=']);
export const v12 = v10.attach(2, v11);
export const v13 = Linear(['O']);
export const v14 = v12.attach(4, v13);
export const v15 = Ring({ atoms: 'C', size: 5, ringNumber: 3 });
export const v16 = Linear(['N', 'C']);
export const v17 = Linear(['C']);
export const v18 = v16.attach(1, v17);
export const v19 = v15.attach(2, v18);
export const v20 = Linear(['O']);
export const v21 = v19.attach(3, v20);
export const v22 = Linear(['O'], ['=']);
export const v23 = v21.attach(4, v22);
export const v24 = Linear(['O']);
export const v25 = v23.attach(5, v24);
export const v26 = FusedRing({ metadata: { rings: [{ ring: v4, start: 3, end: 8, atoms: [{ position: 3, depth: 0, value: 'c', rings: [1, 1] }, { position: 4, depth: 0, value: 'c', rings: [1] }, { position: 5, depth: 0, value: 'c', rings: [1] }, { position: 6, depth: 0, value: 'c', rings: [2, 1, 2] }, { position: 7, depth: 0, value: 'c', rings: [1, 2] }, { position: 8, depth: 1, value: 'c', rings: [1], branchId: 12 }] }, { ring: v9, start: 6, end: 26, atoms: [{ position: 6, depth: 0, value: 'c', rings: [2, 1, 2] }, { position: 7, depth: 0, value: 'c', rings: [1, 2] }, { position: 9, depth: 0, value: 'C', rings: [2] }, { position: 11, depth: 0, value: 'C', bond: '=', rings: [1, 1, 2] }, { position: 25, depth: 0, value: 'C', rings: [1, 2] }, { position: 26, depth: 0, value: 'C', bond: '=', rings: [2] }] }, { ring: v14, start: 11, end: 25, atoms: [{ position: 11, depth: 0, value: 'C', bond: '=', rings: [1, 1, 2] }, { position: 12, depth: 0, value: 'C', rings: [1] }, { position: 14, depth: 0, value: 'C', rings: [3, 3, 1] }, { position: 23, depth: 0, value: 'C', rings: [3, 1] }, { position: 25, depth: 0, value: 'C', rings: [1, 2] }] }, { ring: v25, start: 14, end: 23, atoms: [{ position: 14, depth: 0, value: 'C', rings: [3, 3, 1] }, { position: 15, depth: 0, value: 'C', rings: [3] }, { position: 19, depth: 0, value: 'C', rings: [3] }, { position: 21, depth: 0, value: 'C', rings: [3] }, { position: 23, depth: 0, value: 'C', rings: [3, 1] }] }] } });
export const v27 = Linear(['O']);
export const v28 = Molecule([v3, v26, v27]);"
`;

exports[`Erythromycin Integration Test parses erythromycin 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "C",
      ],
      "attachments": {},
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "atoms": "C",
      "attachments": {
        "10": [
          {
            "components": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
              {
                "atoms": "C",
                "attachments": {
                  "2": [
                    {
                      "atoms": [
                        "O",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                  "3": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 3,
                "size": 6,
                "substitutions": {
                  "6": "O",
                },
                "type": "ring",
              },
              {
                "atoms": [
                  "O",
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "type": "molecule",
          },
        ],
        "11": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "12": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "13": [
          {
            "components": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
              {
                "atoms": "C",
                "attachments": {
                  "3": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 2,
                "size": 6,
                "substitutions": {
                  "6": "O",
                },
                "type": "ring",
              },
              {
                "atoms": [
                  "N",
                  "C",
                ],
                "attachments": {
                  "1": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "type": "molecule",
          },
        ],
        "3": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
        "4": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "6": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "8": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "9": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 14,
      "substitutions": {
        "2": "O",
      },
      "type": "ring",
    },
    {
      "atoms": [
        "O",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Erythromycin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CC');
export const v2 = Fragment('C1CCC(CC(CC(C(C(C(C(C(C1))))))))');
export const v3 = Fragment('C1OCC(CC(CC(C(C(C(C(C(C1))))))))');
export const v4 = Linear(['O'], ['=']);
export const v5 = v3.attach(3, v4, { sibling: true });
export const v6 = Fragment('C');
export const v7 = v5.attach(4, v6, { sibling: false });
export const v8 = Fragment('C');
export const v9 = v7.attach(6, v8, { sibling: false });
export const v10 = Fragment('O');
export const v11 = v9.attach(8, v10, { sibling: false });
export const v12 = Fragment('C');
export const v13 = v11.attach(9, v12, { sibling: false });
export const v14 = Fragment('O');
export const v15 = Fragment('C3C(C(CC(C3)))');
export const v16 = Fragment('C3C(C(CC(O3)))');
export const v17 = Fragment('O');
export const v18 = v16.attach(2, v17, { sibling: false });
export const v19 = Fragment('C');
export const v20 = v18.attach(3, v19, { sibling: false });
export const v21 = Fragment('OC');
export const v22 = Molecule([v14, v20, v21]);
export const v23 = v13.attach(10, v22, { sibling: false });
export const v24 = Fragment('C');
export const v25 = v23.attach(11, v24, { sibling: false });
export const v26 = Fragment('O');
export const v27 = v25.attach(12, v26, { sibling: false });
export const v28 = Fragment('O');
export const v29 = Fragment('C2CC(CC(C2))');
export const v30 = Fragment('C2CC(CC(O2))');
export const v31 = Fragment('C');
export const v32 = v30.attach(3, v31, { sibling: false });
export const v33 = Fragment('NC');
export const v34 = Fragment('C');
export const v35 = v33.attach(1, v34);
export const v36 = Molecule([v28, v32, v35]);
export const v37 = v27.attach(13, v36, { sibling: false });
export const v38 = Linear(['O'], [], {}, '=');
export const v39 = Molecule([v1, v37, v38]);"
`;

exports[`Erythromycin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'C']);
export const v2 = Ring({ atoms: 'C', size: 14, branchDepths: [0, 0, 0, 0, 1, 1, 2, 2, 3, 4, 5, 6, 7, 8] });
export const v3 = v2.substitute(2, 'O');
export const v4 = Linear(['O'], ['=']);
export const v5 = v3.attach(3, v4, { sibling: true });
export const v6 = Linear(['C']);
export const v7 = v5.attach(4, v6, { sibling: false });
export const v8 = Linear(['C']);
export const v9 = v7.attach(6, v8, { sibling: false });
export const v10 = Linear(['O']);
export const v11 = v9.attach(8, v10, { sibling: false });
export const v12 = Linear(['C']);
export const v13 = v11.attach(9, v12, { sibling: false });
export const v14 = Linear(['O']);
export const v15 = Ring({ atoms: 'C', size: 6, ringNumber: 3, branchDepths: [5, 5, 6, 7, 7, 8] });
export const v16 = v15.substitute(6, 'O');
export const v17 = Linear(['O']);
export const v18 = v16.attach(2, v17, { sibling: false });
export const v19 = Linear(['C']);
export const v20 = v18.attach(3, v19, { sibling: false });
export const v21 = Linear(['O', 'C']);
export const v22 = Molecule([v14, v20, v21]);
export const v23 = v13.attach(10, v22, { sibling: false });
export const v24 = Linear(['C']);
export const v25 = v23.attach(11, v24, { sibling: false });
export const v26 = Linear(['O']);
export const v27 = v25.attach(12, v26, { sibling: false });
export const v28 = Linear(['O']);
export const v29 = Ring({ atoms: 'C', size: 6, ringNumber: 2, branchDepths: [8, 8, 8, 9, 9, 10] });
export const v30 = v29.substitute(6, 'O');
export const v31 = Linear(['C']);
export const v32 = v30.attach(3, v31, { sibling: false });
export const v33 = Linear(['N', 'C']);
export const v34 = Linear(['C']);
export const v35 = v33.attach(1, v34);
export const v36 = Molecule([v28, v32, v35]);
export const v37 = v27.attach(13, v36, { sibling: false });
export const v38 = Linear(['O'], [], {}, '=');
export const v39 = Molecule([v1, v37, v38]);"
`;

exports[`Azithromycin Integration Test parses azithromycin 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "C",
      ],
      "attachments": {},
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "atoms": "C",
      "attachments": {
        "10": [
          {
            "components": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
              {
                "atoms": "C",
                "attachments": {
                  "2": [
                    {
                      "atoms": [
                        "O",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                  "3": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 3,
                "size": 6,
                "substitutions": {
                  "6": "O",
                },
                "type": "ring",
              },
              {
                "atoms": [
                  "O",
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "type": "molecule",
          },
        ],
        "11": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "12": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "13": [
          {
            "components": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
              {
                "atoms": "C",
                "attachments": {
                  "3": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 2,
                "size": 6,
                "substitutions": {
                  "6": "O",
                },
                "type": "ring",
              },
              {
                "atoms": [
                  "N",
                  "C",
                ],
                "attachments": {
                  "1": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "type": "molecule",
          },
        ],
        "3": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
        "4": [
          {
            "atoms": [
              "C",
              "N",
              "C",
            ],
            "attachments": {
              "2": [
                {
                  "atoms": [
                    "C",
                  ],
                  "attachments": {},
                  "bonds": [
                    null,
                  ],
                  "type": "linear",
                },
              ],
            },
            "bonds": [
              null,
              null,
              null,
            ],
            "type": "linear",
          },
        ],
        "6": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "8": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "9": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 14,
      "substitutions": {
        "2": "O",
      },
      "type": "ring",
    },
    {
      "atoms": [
        "O",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Azithromycin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CC');
export const v2 = Fragment('C1CCC(CC(CC(C(C(C(C(C(C1))))))))');
export const v3 = Fragment('C1OCC(CC(CC(C(C(C(C(C(C1))))))))');
export const v4 = Linear(['O'], ['=']);
export const v5 = v3.attach(3, v4, { sibling: true });
export const v6 = Fragment('CNC');
export const v7 = Fragment('C');
export const v8 = v6.attach(2, v7);
export const v9 = v5.attach(4, v8, { sibling: false });
export const v10 = Fragment('C');
export const v11 = v9.attach(6, v10, { sibling: false });
export const v12 = Fragment('O');
export const v13 = v11.attach(8, v12, { sibling: false });
export const v14 = Fragment('C');
export const v15 = v13.attach(9, v14, { sibling: false });
export const v16 = Fragment('O');
export const v17 = Fragment('C3C(C(CC(C3)))');
export const v18 = Fragment('C3C(C(CC(O3)))');
export const v19 = Fragment('O');
export const v20 = v18.attach(2, v19, { sibling: false });
export const v21 = Fragment('C');
export const v22 = v20.attach(3, v21, { sibling: false });
export const v23 = Fragment('OC');
export const v24 = Molecule([v16, v22, v23]);
export const v25 = v15.attach(10, v24, { sibling: false });
export const v26 = Fragment('C');
export const v27 = v25.attach(11, v26, { sibling: false });
export const v28 = Fragment('O');
export const v29 = v27.attach(12, v28, { sibling: false });
export const v30 = Fragment('O');
export const v31 = Fragment('C2CC(CC(C2))');
export const v32 = Fragment('C2CC(CC(O2))');
export const v33 = Fragment('C');
export const v34 = v32.attach(3, v33, { sibling: false });
export const v35 = Fragment('NC');
export const v36 = Fragment('C');
export const v37 = v35.attach(1, v36);
export const v38 = Molecule([v30, v34, v37]);
export const v39 = v29.attach(13, v38, { sibling: false });
export const v40 = Linear(['O'], [], {}, '=');
export const v41 = Molecule([v1, v39, v40]);"
`;

exports[`Azithromycin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'C']);
export const v2 = Ring({ atoms: 'C', size: 14, branchDepths: [0, 0, 0, 0, 1, 1, 2, 2, 3, 4, 5, 6, 7, 8] });
export const v3 = v2.substitute(2, 'O');
export const v4 = Linear(['O'], ['=']);
export const v5 = v3.attach(3, v4, { sibling: true });
export const v6 = Linear(['C', 'N', 'C']);
export const v7 = Linear(['C']);
export const v8 = v6.attach(2, v7);
export const v9 = v5.attach(4, v8, { sibling: false });
export const v10 = Linear(['C']);
export const v11 = v9.attach(6, v10, { sibling: false });
export const v12 = Linear(['O']);
export const v13 = v11.attach(8, v12, { sibling: false });
export const v14 = Linear(['C']);
export const v15 = v13.attach(9, v14, { sibling: false });
export const v16 = Linear(['O']);
export const v17 = Ring({ atoms: 'C', size: 6, ringNumber: 3, branchDepths: [5, 5, 6, 7, 7, 8] });
export const v18 = v17.substitute(6, 'O');
export const v19 = Linear(['O']);
export const v20 = v18.attach(2, v19, { sibling: false });
export const v21 = Linear(['C']);
export const v22 = v20.attach(3, v21, { sibling: false });
export const v23 = Linear(['O', 'C']);
export const v24 = Molecule([v16, v22, v23]);
export const v25 = v15.attach(10, v24, { sibling: false });
export const v26 = Linear(['C']);
export const v27 = v25.attach(11, v26, { sibling: false });
export const v28 = Linear(['O']);
export const v29 = v27.attach(12, v28, { sibling: false });
export const v30 = Linear(['O']);
export const v31 = Ring({ atoms: 'C', size: 6, ringNumber: 2, branchDepths: [8, 8, 8, 9, 9, 10] });
export const v32 = v31.substitute(6, 'O');
export const v33 = Linear(['C']);
export const v34 = v32.attach(3, v33, { sibling: false });
export const v35 = Linear(['N', 'C']);
export const v36 = Linear(['C']);
export const v37 = v35.attach(1, v36);
export const v38 = Molecule([v30, v34, v37]);
export const v39 = v29.attach(13, v38, { sibling: false });
export const v40 = Linear(['O'], [], {}, '=');
export const v41 = Molecule([v1, v39, v40]);"
`;

exports[`Clarithromycin Integration Test parses clarithromycin 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "C",
      ],
      "attachments": {},
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "atoms": "C",
      "attachments": {
        "10": [
          {
            "components": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
              {
                "atoms": "C",
                "attachments": {
                  "2": [
                    {
                      "atoms": [
                        "O",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                  "3": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 3,
                "size": 6,
                "substitutions": {
                  "6": "O",
                },
                "type": "ring",
              },
              {
                "atoms": [
                  "O",
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "type": "molecule",
          },
        ],
        "11": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "12": [
          {
            "atoms": [
              "O",
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
              null,
            ],
            "type": "linear",
          },
        ],
        "13": [
          {
            "components": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
              {
                "atoms": "C",
                "attachments": {
                  "3": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 2,
                "size": 6,
                "substitutions": {
                  "6": "O",
                },
                "type": "ring",
              },
              {
                "atoms": [
                  "N",
                  "C",
                ],
                "attachments": {
                  "1": [
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "type": "molecule",
          },
        ],
        "3": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
        "4": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "6": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "8": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "9": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 14,
      "substitutions": {
        "2": "O",
      },
      "type": "ring",
    },
    {
      "atoms": [
        "O",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Clarithromycin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CC');
export const v2 = Fragment('C1CCC(CC(CC(C(C(C(C(C(C1))))))))');
export const v3 = Fragment('C1OCC(CC(CC(C(C(C(C(C(C1))))))))');
export const v4 = Linear(['O'], ['=']);
export const v5 = v3.attach(3, v4, { sibling: true });
export const v6 = Fragment('C');
export const v7 = v5.attach(4, v6, { sibling: false });
export const v8 = Fragment('C');
export const v9 = v7.attach(6, v8, { sibling: false });
export const v10 = Fragment('O');
export const v11 = v9.attach(8, v10, { sibling: false });
export const v12 = Fragment('C');
export const v13 = v11.attach(9, v12, { sibling: false });
export const v14 = Fragment('O');
export const v15 = Fragment('C3C(C(CC(C3)))');
export const v16 = Fragment('C3C(C(CC(O3)))');
export const v17 = Fragment('O');
export const v18 = v16.attach(2, v17, { sibling: false });
export const v19 = Fragment('C');
export const v20 = v18.attach(3, v19, { sibling: false });
export const v21 = Fragment('OC');
export const v22 = Molecule([v14, v20, v21]);
export const v23 = v13.attach(10, v22, { sibling: false });
export const v24 = Fragment('C');
export const v25 = v23.attach(11, v24, { sibling: false });
export const v26 = Fragment('OC');
export const v27 = v25.attach(12, v26, { sibling: false });
export const v28 = Fragment('O');
export const v29 = Fragment('C2CC(CC(C2))');
export const v30 = Fragment('C2CC(CC(O2))');
export const v31 = Fragment('C');
export const v32 = v30.attach(3, v31, { sibling: false });
export const v33 = Fragment('NC');
export const v34 = Fragment('C');
export const v35 = v33.attach(1, v34);
export const v36 = Molecule([v28, v32, v35]);
export const v37 = v27.attach(13, v36, { sibling: false });
export const v38 = Linear(['O'], [], {}, '=');
export const v39 = Molecule([v1, v37, v38]);"
`;

exports[`Clarithromycin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'C']);
export const v2 = Ring({ atoms: 'C', size: 14, branchDepths: [0, 0, 0, 0, 1, 1, 2, 2, 3, 4, 5, 6, 7, 8] });
export const v3 = v2.substitute(2, 'O');
export const v4 = Linear(['O'], ['=']);
export const v5 = v3.attach(3, v4, { sibling: true });
export const v6 = Linear(['C']);
export const v7 = v5.attach(4, v6, { sibling: false });
export const v8 = Linear(['C']);
export const v9 = v7.attach(6, v8, { sibling: false });
export const v10 = Linear(['O']);
export const v11 = v9.attach(8, v10, { sibling: false });
export const v12 = Linear(['C']);
export const v13 = v11.attach(9, v12, { sibling: false });
export const v14 = Linear(['O']);
export const v15 = Ring({ atoms: 'C', size: 6, ringNumber: 3, branchDepths: [5, 5, 6, 7, 7, 8] });
export const v16 = v15.substitute(6, 'O');
export const v17 = Linear(['O']);
export const v18 = v16.attach(2, v17, { sibling: false });
export const v19 = Linear(['C']);
export const v20 = v18.attach(3, v19, { sibling: false });
export const v21 = Linear(['O', 'C']);
export const v22 = Molecule([v14, v20, v21]);
export const v23 = v13.attach(10, v22, { sibling: false });
export const v24 = Linear(['C']);
export const v25 = v23.attach(11, v24, { sibling: false });
export const v26 = Linear(['O', 'C']);
export const v27 = v25.attach(12, v26, { sibling: false });
export const v28 = Linear(['O']);
export const v29 = Ring({ atoms: 'C', size: 6, ringNumber: 2, branchDepths: [8, 8, 8, 9, 9, 10] });
export const v30 = v29.substitute(6, 'O');
export const v31 = Linear(['C']);
export const v32 = v30.attach(3, v31, { sibling: false });
export const v33 = Linear(['N', 'C']);
export const v34 = Linear(['C']);
export const v35 = v33.attach(1, v34);
export const v36 = Molecule([v28, v32, v35]);
export const v37 = v27.attach(13, v36, { sibling: false });
export const v38 = Linear(['O'], [], {}, '=');
export const v39 = Molecule([v1, v37, v38]);"
`;

exports[`Trimethoprim Integration Test parses trimethoprim 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {},
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "atoms": "c",
      "attachments": {
        "3": [
          {
            "components": [
              {
                "atoms": [
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
              {
                "components": [
                  {
                    "atoms": "c",
                    "attachments": {
                      "4": [
                        {
                          "atoms": [
                            "N",
                          ],
                          "attachments": {},
                          "bonds": [
                            null,
                          ],
                          "type": "linear",
                        },
                      ],
                    },
                    "bonds": [
                      null,
                      null,
                      null,
                      null,
                      null,
                      null,
                    ],
                    "offset": 0,
                    "ringNumber": 2,
                    "size": 6,
                    "substitutions": {
                      "3": "n",
                      "5": "n",
                    },
                    "type": "ring",
                  },
                  {
                    "atoms": [
                      "N",
                    ],
                    "attachments": {},
                    "bonds": [],
                    "type": "linear",
                  },
                ],
                "type": "molecule",
              },
            ],
            "type": "molecule",
          },
        ],
        "5": [
          {
            "atoms": [
              "O",
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 6,
      "substitutions": {},
      "type": "ring",
    },
    {
      "atoms": [
        "O",
        "C",
      ],
      "attachments": {},
      "bonds": [
        null,
      ],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Trimethoprim Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CO');
export const v2 = Fragment('c1ccccc1');
export const v3 = Fragment('C');
export const v4 = Fragment('c2ccccc2');
export const v5 = Fragment('c2cncnc2');
export const v6 = Fragment('N');
export const v7 = v5.attach(4, v6);
export const v8 = Fragment('N');
export const v9 = Molecule([v7, v8]);
export const v10 = Molecule([v3, v9]);
export const v11 = v2.attach(3, v10);
export const v12 = Fragment('OC');
export const v13 = v11.attach(5, v12);
export const v14 = Fragment('OC');
export const v15 = Molecule([v1, v13, v14]);"
`;

exports[`Trimethoprim Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'O']);
export const v2 = Ring({ atoms: 'c', size: 6 });
export const v3 = Linear(['C']);
export const v4 = Ring({ atoms: 'c', size: 6, ringNumber: 2 });
export const v5 = v4.substitute(3, 'n');
export const v6 = v5.substitute(5, 'n');
export const v7 = Linear(['N']);
export const v8 = v6.attach(4, v7);
export const v9 = Linear(['N']);
export const v10 = Molecule([v8, v9]);
export const v11 = Molecule([v3, v10]);
export const v12 = v2.attach(3, v11);
export const v13 = Linear(['O', 'C']);
export const v14 = v12.attach(5, v13);
export const v15 = Linear(['O', 'C']);
export const v16 = Molecule([v1, v14, v15]);"
`;

exports[`Sulfamethoxazole Integration Test parses sulfamethoxazole 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "atoms": "c",
      "attachments": {
        "3": [
          {
            "components": [
              {
                "atoms": [
                  "N",
                  "S",
                ],
                "attachments": {
                  "2": [
                    {
                      "atoms": [
                        "O",
                      ],
                      "attachments": {},
                      "bonds": [
                        "=",
                      ],
                      "type": "linear",
                    },
                    {
                      "atoms": [
                        "O",
                      ],
                      "attachments": {},
                      "bonds": [
                        "=",
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                ],
                "type": "linear",
              },
              {
                "atoms": "c",
                "attachments": {
                  "4": [
                    {
                      "atoms": [
                        "N",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                  ],
                },
                "bonds": [
                  null,
                  null,
                  null,
                  null,
                  null,
                  null,
                ],
                "offset": 0,
                "ringNumber": 2,
                "size": 6,
                "substitutions": {},
                "type": "ring",
              },
            ],
            "type": "molecule",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 5,
      "substitutions": {
        "4": "n",
        "5": "o",
      },
      "type": "ring",
    },
  ],
  "type": "molecule",
}
`;

exports[`Sulfamethoxazole Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('C');
export const v2 = Fragment('c1cccc1');
export const v3 = Fragment('c1ccno1');
export const v4 = Fragment('NS');
export const v5 = Linear(['O'], ['=']);
export const v6 = v4.attach(2, v5);
export const v7 = Linear(['O'], ['=']);
export const v8 = v6.attach(2, v7);
export const v9 = Fragment('c2ccccc2');
export const v10 = Fragment('N');
export const v11 = v9.attach(4, v10);
export const v12 = Molecule([v8, v11]);
export const v13 = v3.attach(3, v12);
export const v14 = Molecule([v1, v13]);"
`;

exports[`Sulfamethoxazole Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C']);
export const v2 = Ring({ atoms: 'c', size: 5 });
export const v3 = v2.substitute(4, 'n');
export const v4 = v3.substitute(5, 'o');
export const v5 = Linear(['N', 'S']);
export const v6 = Linear(['O'], ['=']);
export const v7 = v5.attach(2, v6);
export const v8 = Linear(['O'], ['=']);
export const v9 = v7.attach(2, v8);
export const v10 = Ring({ atoms: 'c', size: 6, ringNumber: 2 });
export const v11 = Linear(['N']);
export const v12 = v10.attach(4, v11);
export const v13 = Molecule([v9, v12]);
export const v14 = v4.attach(3, v13);
export const v15 = Molecule([v1, v14]);"
`;

exports[`Metronidazole Integration Test parses metronidazole 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "atoms": "c",
      "attachments": {
        "4": [
          {
            "atoms": [
              "[N+]",
              "[O-]",
            ],
            "attachments": {
              "1": [
                {
                  "atoms": [
                    "O",
                  ],
                  "attachments": {},
                  "bonds": [
                    "=",
                  ],
                  "type": "linear",
                },
              ],
            },
            "bonds": [
              null,
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 5,
      "substitutions": {
        "2": "n",
        "5": "n",
      },
      "type": "ring",
    },
    {
      "atoms": [
        "C",
        "C",
        "O",
      ],
      "attachments": {},
      "bonds": [
        null,
        null,
      ],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Metronidazole Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('C');
export const v2 = Fragment('c1cccc1');
export const v3 = Fragment('c1nccn1');
export const v4 = Fragment('[N+][O-]');
export const v5 = Linear(['O'], ['=']);
export const v6 = v4.attach(1, v5);
export const v7 = v3.attach(4, v6);
export const v8 = Fragment('CCO');
export const v9 = Molecule([v1, v7, v8]);"
`;

exports[`Metronidazole Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C']);
export const v2 = Ring({ atoms: 'c', size: 5 });
export const v3 = v2.substitute(2, 'n');
export const v4 = v3.substitute(5, 'n');
export const v5 = Linear(['[N+]', '[O-]']);
export const v6 = Linear(['O'], ['=']);
export const v7 = v5.attach(1, v6);
export const v8 = v4.attach(4, v7);
export const v9 = Linear(['C', 'C', 'O']);
export const v10 = Molecule([v1, v8, v9]);"
`;

exports[`Vancomycin Integration Test parses vancomycin 1`] = `
{
  "components": [
    {
      "atoms": [
        "O",
        "C",
      ],
      "attachments": {
        "2": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        "=",
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "13": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "19": [
              {
                "components": [
                  {
                    "atoms": [
                      "N",
                      "C",
                      "C",
                      "C",
                    ],
                    "attachments": {
                      "2": [
                        {
                          "atoms": [
                            "O",
                          ],
                          "attachments": {},
                          "bonds": [
                            "=",
                          ],
                          "type": "linear",
                        },
                      ],
                      "3": [
                        {
                          "atoms": [
                            "N",
                          ],
                          "attachments": {},
                          "bonds": [
                            null,
                          ],
                          "type": "linear",
                        },
                      ],
                    },
                    "bonds": [
                      null,
                      null,
                      null,
                      null,
                    ],
                    "type": "linear",
                  },
                  {
                    "atoms": "c",
                    "attachments": {
                      "4": [
                        {
                          "atoms": [
                            "O",
                          ],
                          "attachments": {},
                          "bonds": [
                            null,
                          ],
                          "type": "linear",
                        },
                      ],
                    },
                    "bonds": [
                      null,
                      null,
                      null,
                      null,
                      null,
                      null,
                    ],
                    "offset": 0,
                    "ringNumber": 3,
                    "size": 6,
                    "substitutions": {},
                    "type": "ring",
                  },
                ],
                "type": "molecule",
              },
            ],
            "20": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "4": [
              {
                "components": [
                  {
                    "atoms": [
                      "C",
                    ],
                    "attachments": {},
                    "bonds": [
                      null,
                    ],
                    "type": "linear",
                  },
                  {
                    "atoms": "c",
                    "attachments": {
                      "3": [
                        {
                          "atoms": [
                            "Cl",
                          ],
                          "attachments": {},
                          "bonds": [
                            null,
                          ],
                          "type": "linear",
                        },
                      ],
                      "4": [
                        {
                          "components": [
                            {
                              "atoms": [
                                "O",
                              ],
                              "attachments": {},
                              "bonds": [
                                null,
                              ],
                              "type": "linear",
                            },
                            {
                              "rings": [
                                {
                                  "atoms": "c",
                                  "attachments": {},
                                  "bonds": [
                                    null,
                                    null,
                                    null,
                                    null,
                                    null,
                                    null,
                                  ],
                                  "offset": 0,
                                  "ringNumber": 3,
                                  "size": 6,
                                  "substitutions": {},
                                  "type": "ring",
                                },
                                {
                                  "atoms": "c",
                                  "attachments": {
                                    "3": [
                                      {
                                        "atoms": [
                                          "Cl",
                                        ],
                                        "attachments": {},
                                        "bonds": [
                                          null,
                                        ],
                                        "type": "linear",
                                      },
                                    ],
                                    "4": [
                                      {
                                        "atoms": [
                                          "O",
                                        ],
                                        "attachments": {},
                                        "bonds": [
                                          null,
                                        ],
                                        "type": "linear",
                                      },
                                    ],
                                    "5": [
                                      {
                                        "atoms": [
                                          "C",
                                          "N",
                                          "C",
                                          "C",
                                          "O",
                                        ],
                                        "attachments": {
                                          "1": [
                                            {
                                              "atoms": [
                                                "O",
                                              ],
                                              "attachments": {},
                                              "bonds": [
                                                "=",
                                              ],
                                              "type": "linear",
                                            },
                                          ],
                                          "3": [
                                            {
                                              "atoms": [
                                                "C",
                                                "C",
                                                "O",
                                              ],
                                              "attachments": {
                                                "2": [
                                                  {
                                                    "atoms": [
                                                      "N",
                                                    ],
                                                    "attachments": {},
                                                    "bonds": [
                                                      null,
                                                    ],
                                                    "type": "linear",
                                                  },
                                                ],
                                              },
                                              "bonds": [
                                                null,
                                                null,
                                                "=",
                                              ],
                                              "type": "linear",
                                            },
                                          ],
                                          "4": [
                                            {
                                              "atoms": [
                                                "O",
                                              ],
                                              "attachments": {},
                                              "bonds": [
                                                "=",
                                              ],
                                              "type": "linear",
                                            },
                                          ],
                                        },
                                        "bonds": [
                                          null,
                                          null,
                                          null,
                                          null,
                                          null,
                                        ],
                                        "type": "linear",
                                      },
                                    ],
                                  },
                                  "bonds": [
                                    null,
                                    null,
                                    null,
                                    null,
                                    null,
                                    null,
                                  ],
                                  "offset": 2,
                                  "ringNumber": 4,
                                  "size": 6,
                                  "substitutions": {},
                                  "type": "ring",
                                },
                              ],
                              "type": "fused_ring",
                            },
                          ],
                          "type": "molecule",
                        },
                      ],
                    },
                    "bonds": [
                      null,
                      null,
                      null,
                      null,
                      null,
                      null,
                    ],
                    "offset": 0,
                    "ringNumber": 2,
                    "size": 6,
                    "substitutions": {},
                    "type": "ring",
                  },
                ],
                "type": "molecule",
              },
            ],
            "6": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "9": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "-",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 21,
          "substitutions": {
            "10": "c",
            "11": "c",
            "12": "c",
            "13": "c",
            "14": "c",
            "15": "c",
            "16": "c",
            "17": "c",
            "2": "N",
            "21": "N",
            "5": "N",
            "8": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {
            "4": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 9,
          "ringNumber": 2,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "c",
          "attachments": {},
          "bonds": [
            null,
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 14,
          "ringNumber": 2,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "atoms": "c",
      "attachments": {
        "4": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 2,
      "size": 6,
      "substitutions": {},
      "type": "ring",
    },
  ],
  "type": "molecule",
}
`;

exports[`Vancomycin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C'], ['=']);
export const v2 = Fragment('O');
export const v3 = v1.attach(2, v2);
export const v4 = Fragment('C1CCCCCC(CCCCCCC-CCC(CCCC1))');
export const v5 = Fragment('C1NCCNCC(NCccccc-ccc(CCCN1))');
export const v6 = Linear(['O'], ['=']);
export const v7 = v5.attach(3, v6, { sibling: true });
export const v8 = Fragment('C');
export const v9 = Fragment('c2ccccc2');
export const v10 = Fragment('Cl');
export const v11 = v9.attach(3, v10);
export const v12 = Fragment('O');
export const v13 = Fragment('c3ccccc3');
export const v14 = Fragment('c4ccccc4');
export const v15 = Fragment('Cl');
export const v16 = v14.attach(3, v15);
export const v17 = Fragment('O');
export const v18 = v16.attach(4, v17);
export const v19 = Fragment('CNCCO');
export const v20 = Linear(['O'], ['=']);
export const v21 = v19.attach(1, v20);
export const v22 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v23 = Fragment('N');
export const v24 = v22.attach(2, v23);
export const v25 = v21.attach(3, v24);
export const v26 = Linear(['O'], ['=']);
export const v27 = v25.attach(4, v26);
export const v28 = v18.attach(5, v27);
export const v29 = FusedRing({ metadata: { rings: [{ ring: v13, start: 15, end: 37, atoms: [{ position: 15, depth: 2, value: 'c', rings: [3, 3], branchId: 25 }, { position: 16, depth: 2, value: 'c', rings: [3], branchId: 25 }, { position: 17, depth: 2, value: 'c', rings: [4, 4, 3], branchId: 25 }, { position: 35, depth: 2, value: 'c', rings: [4, 3], branchId: 25 }, { position: 36, depth: 2, value: 'c', rings: [3], branchId: 25 }, { position: 37, depth: 2, value: 'c', rings: [3], branchId: 25 }] }, { ring: v28, start: 17, end: 35, atoms: [{ position: 17, depth: 2, value: 'c', rings: [4, 4, 3], branchId: 25 }, { position: 18, depth: 2, value: 'c', rings: [4], branchId: 25 }, { position: 19, depth: 2, value: 'c', rings: [4], branchId: 25 }, { position: 21, depth: 2, value: 'c', rings: [4], branchId: 25 }, { position: 23, depth: 2, value: 'c', rings: [4], branchId: 25 }, { position: 35, depth: 2, value: 'c', rings: [4, 3], branchId: 25 }] }], atoms: [{ position: 38, depth: 2, value: 'O', branchId: 25 }] } });
export const v30 = Molecule([v12, v29]);
export const v31 = v11.attach(4, v30);
export const v32 = Molecule([v8, v31]);
export const v33 = v7.attach(4, v32, { sibling: true });
export const v34 = Linear(['O'], ['=']);
export const v35 = v33.attach(6, v34, { sibling: true });
export const v36 = Linear(['O'], ['=']);
export const v37 = v35.attach(9, v36, { sibling: true });
export const v38 = Fragment('O');
export const v39 = v37.attach(13, v38, { sibling: true });
export const v40 = Fragment('NCCC');
export const v41 = Linear(['O'], ['=']);
export const v42 = v40.attach(2, v41);
export const v43 = Fragment('N');
export const v44 = v42.attach(3, v43);
export const v45 = Fragment('c3ccccc3');
export const v46 = Fragment('O');
export const v47 = v45.attach(4, v46);
export const v48 = Molecule([v44, v47]);
export const v49 = v39.attach(19, v48, { sibling: true });
export const v50 = Linear(['O'], ['=']);
export const v51 = v49.attach(20, v50, { sibling: true });
export const v52 = Fragment('c2cccc(c2)');
export const v53 = Fragment('O');
export const v54 = v52.attach(4, v53, { sibling: true });
export const v55 = Ring({ atoms: 'c', size: 6, ringNumber: 2, offset: 14, leadingBond: '-' });
export const v56 = FusedRing({ metadata: { rings: [{ ring: v51, start: 3, end: 75, atoms: [{ position: 3, depth: 0, value: 'C', rings: [1, 1] }, { position: 4, depth: 0, value: 'N', rings: [1] }, { position: 5, depth: 0, value: 'C', rings: [1] }, { position: 7, depth: 0, value: 'C', rings: [1] }, { position: 41, depth: 0, value: 'N', rings: [1] }, { position: 42, depth: 0, value: 'C', rings: [1] }, { position: 44, depth: 0, value: 'C', rings: [1] }, { position: 45, depth: 1, value: 'N', rings: [1], branchId: 84 }, { position: 46, depth: 1, value: 'C', rings: [1], branchId: 84 }, { position: 48, depth: 1, value: 'c', rings: [2, 2, 1], branchId: 84 }, { position: 49, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 50, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 51, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 53, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 55, depth: 1, value: 'c', bond: '-', rings: [2, 1, 2], branchId: 84 }, { position: 56, depth: 1, value: 'c', rings: [1, 2], branchId: 84 }, { position: 57, depth: 1, value: 'c', rings: [1, 2], branchId: 84 }, { position: 58, depth: 2, value: 'C', rings: [1], branchId: 109 }, { position: 59, depth: 2, value: 'C', rings: [1], branchId: 109 }, { position: 73, depth: 2, value: 'C', rings: [1], branchId: 109 }, { position: 75, depth: 2, value: 'N', rings: [1], branchId: 109 }] }, { ring: v54, start: 48, end: 54, atoms: [{ position: 48, depth: 1, value: 'c', rings: [2, 2, 1], branchId: 84 }, { position: 49, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 50, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 51, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 53, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 54, depth: 2, value: 'c', rings: [2], branchId: 100 }] }, { ring: v55, start: 55, end: 78, atoms: [{ position: 55, depth: 1, value: 'c', bond: '-', rings: [2, 1, 2], branchId: 84 }, { position: 56, depth: 1, value: 'c', rings: [1, 2], branchId: 84 }, { position: 57, depth: 1, value: 'c', rings: [1, 2], branchId: 84 }, { position: 76, depth: 1, value: 'c', rings: [2], branchId: 84 }, { position: 77, depth: 1, value: 'c', rings: [2], branchId: 84 }, { position: 78, depth: 1, value: 'c', rings: [2], branchId: 84 }] }], atoms: [{ position: 79, depth: 1, value: 'O', branchId: 84 }] } });
export const v57 = Fragment('C');
export const v58 = Fragment('c2ccccc2');
export const v59 = Fragment('O');
export const v60 = v58.attach(4, v59);
export const v61 = Molecule([v3, v56, v57, v60]);"
`;

exports[`Vancomycin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C'], ['=']);
export const v2 = Linear(['O']);
export const v3 = v1.attach(2, v2);
export const v4 = Ring({ atoms: 'C', size: 21, bonds: [null, null, null, null, null, null, null, null, null, null, null, null, null, '-', null, null, null, null, null, null, null], branchDepths: [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2] });
export const v5 = v4.substitute(2, 'N');
export const v6 = v5.substitute(5, 'N');
export const v7 = v6.substitute(8, 'N');
export const v8 = v7.substitute(10, 'c');
export const v9 = v8.substitute(11, 'c');
export const v10 = v9.substitute(12, 'c');
export const v11 = v10.substitute(13, 'c');
export const v12 = v11.substitute(14, 'c');
export const v13 = v12.substitute(15, 'c');
export const v14 = v13.substitute(16, 'c');
export const v15 = v14.substitute(17, 'c');
export const v16 = v15.substitute(21, 'N');
export const v17 = Linear(['O'], ['=']);
export const v18 = v16.attach(3, v17, { sibling: true });
export const v19 = Linear(['C']);
export const v20 = Ring({ atoms: 'c', size: 6, ringNumber: 2 });
export const v21 = Linear(['Cl']);
export const v22 = v20.attach(3, v21);
export const v23 = Linear(['O']);
export const v24 = Ring({ atoms: 'c', size: 6, ringNumber: 3 });
export const v25 = Ring({ atoms: 'c', size: 6, ringNumber: 4, offset: 2 });
export const v26 = Linear(['Cl']);
export const v27 = v25.attach(3, v26);
export const v28 = Linear(['O']);
export const v29 = v27.attach(4, v28);
export const v30 = Linear(['C', 'N', 'C', 'C', 'O']);
export const v31 = Linear(['O'], ['=']);
export const v32 = v30.attach(1, v31);
export const v33 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v34 = Linear(['N']);
export const v35 = v33.attach(2, v34);
export const v36 = v32.attach(3, v35);
export const v37 = Linear(['O'], ['=']);
export const v38 = v36.attach(4, v37);
export const v39 = v29.attach(5, v38);
export const v40 = FusedRing({ metadata: { rings: [{ ring: v24, start: 15, end: 37, atoms: [{ position: 15, depth: 2, value: 'c', rings: [3, 3], branchId: 25 }, { position: 16, depth: 2, value: 'c', rings: [3], branchId: 25 }, { position: 17, depth: 2, value: 'c', rings: [4, 4, 3], branchId: 25 }, { position: 35, depth: 2, value: 'c', rings: [4, 3], branchId: 25 }, { position: 36, depth: 2, value: 'c', rings: [3], branchId: 25 }, { position: 37, depth: 2, value: 'c', rings: [3], branchId: 25 }] }, { ring: v39, start: 17, end: 35, atoms: [{ position: 17, depth: 2, value: 'c', rings: [4, 4, 3], branchId: 25 }, { position: 18, depth: 2, value: 'c', rings: [4], branchId: 25 }, { position: 19, depth: 2, value: 'c', rings: [4], branchId: 25 }, { position: 21, depth: 2, value: 'c', rings: [4], branchId: 25 }, { position: 23, depth: 2, value: 'c', rings: [4], branchId: 25 }, { position: 35, depth: 2, value: 'c', rings: [4, 3], branchId: 25 }] }], atoms: [{ position: 38, depth: 2, value: 'O', branchId: 25 }] } });
export const v41 = Molecule([v23, v40]);
export const v42 = v22.attach(4, v41);
export const v43 = Molecule([v19, v42]);
export const v44 = v18.attach(4, v43, { sibling: true });
export const v45 = Linear(['O'], ['=']);
export const v46 = v44.attach(6, v45, { sibling: true });
export const v47 = Linear(['O'], ['=']);
export const v48 = v46.attach(9, v47, { sibling: true });
export const v49 = Linear(['O']);
export const v50 = v48.attach(13, v49, { sibling: true });
export const v51 = Linear(['N', 'C', 'C', 'C']);
export const v52 = Linear(['O'], ['=']);
export const v53 = v51.attach(2, v52);
export const v54 = Linear(['N']);
export const v55 = v53.attach(3, v54);
export const v56 = Ring({ atoms: 'c', size: 6, ringNumber: 3 });
export const v57 = Linear(['O']);
export const v58 = v56.attach(4, v57);
export const v59 = Molecule([v55, v58]);
export const v60 = v50.attach(19, v59, { sibling: true });
export const v61 = Linear(['O'], ['=']);
export const v62 = v60.attach(20, v61, { sibling: true });
export const v63 = Ring({ atoms: 'c', size: 6, ringNumber: 2, offset: 9, branchDepths: [1, 1, 1, 1, 1, 2] });
export const v64 = Linear(['O']);
export const v65 = v63.attach(4, v64, { sibling: true });
export const v66 = Ring({ atoms: 'c', size: 6, ringNumber: 2, offset: 14, leadingBond: '-' });
export const v67 = FusedRing({ metadata: { rings: [{ ring: v62, start: 3, end: 75, atoms: [{ position: 3, depth: 0, value: 'C', rings: [1, 1] }, { position: 4, depth: 0, value: 'N', rings: [1] }, { position: 5, depth: 0, value: 'C', rings: [1] }, { position: 7, depth: 0, value: 'C', rings: [1] }, { position: 41, depth: 0, value: 'N', rings: [1] }, { position: 42, depth: 0, value: 'C', rings: [1] }, { position: 44, depth: 0, value: 'C', rings: [1] }, { position: 45, depth: 1, value: 'N', rings: [1], branchId: 84 }, { position: 46, depth: 1, value: 'C', rings: [1], branchId: 84 }, { position: 48, depth: 1, value: 'c', rings: [2, 2, 1], branchId: 84 }, { position: 49, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 50, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 51, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 53, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 55, depth: 1, value: 'c', bond: '-', rings: [2, 1, 2], branchId: 84 }, { position: 56, depth: 1, value: 'c', rings: [1, 2], branchId: 84 }, { position: 57, depth: 1, value: 'c', rings: [1, 2], branchId: 84 }, { position: 58, depth: 2, value: 'C', rings: [1], branchId: 109 }, { position: 59, depth: 2, value: 'C', rings: [1], branchId: 109 }, { position: 73, depth: 2, value: 'C', rings: [1], branchId: 109 }, { position: 75, depth: 2, value: 'N', rings: [1], branchId: 109 }] }, { ring: v65, start: 48, end: 54, atoms: [{ position: 48, depth: 1, value: 'c', rings: [2, 2, 1], branchId: 84 }, { position: 49, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 50, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 51, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 53, depth: 1, value: 'c', rings: [2, 1], branchId: 84 }, { position: 54, depth: 2, value: 'c', rings: [2], branchId: 100 }] }, { ring: v66, start: 55, end: 78, atoms: [{ position: 55, depth: 1, value: 'c', bond: '-', rings: [2, 1, 2], branchId: 84 }, { position: 56, depth: 1, value: 'c', rings: [1, 2], branchId: 84 }, { position: 57, depth: 1, value: 'c', rings: [1, 2], branchId: 84 }, { position: 76, depth: 1, value: 'c', rings: [2], branchId: 84 }, { position: 77, depth: 1, value: 'c', rings: [2], branchId: 84 }, { position: 78, depth: 1, value: 'c', rings: [2], branchId: 84 }] }], atoms: [{ position: 79, depth: 1, value: 'O', branchId: 84 }] } });
export const v68 = Linear(['C']);
export const v69 = Ring({ atoms: 'c', size: 6, ringNumber: 2 });
export const v70 = Linear(['O']);
export const v71 = v69.attach(4, v70);
export const v72 = Molecule([v3, v67, v68, v71]);"
`;

exports[`Linezolid Integration Test parses linezolid 1`] = `
{
  "atoms": [
    "O",
    "C",
    "C",
  ],
  "attachments": {
    "2": [
      {
        "components": [
          {
            "atoms": [
              "N",
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
              null,
            ],
            "type": "linear",
          },
          {
            "components": [
              {
                "atoms": "C",
                "attachments": {
                  "4": [
                    {
                      "components": [
                        {
                          "atoms": "C",
                          "attachments": {
                            "3": [
                              {
                                "atoms": [
                                  "C",
                                  "O",
                                  "C",
                                  "N",
                                ],
                                "attachments": {
                                  "3": [
                                    {
                                      "atoms": [
                                        "O",
                                      ],
                                      "attachments": {},
                                      "bonds": [
                                        "=",
                                      ],
                                      "type": "linear",
                                    },
                                  ],
                                },
                                "bonds": [
                                  null,
                                  null,
                                  null,
                                  null,
                                ],
                                "type": "linear",
                              },
                            ],
                          },
                          "bonds": [
                            null,
                            null,
                            null,
                            null,
                            null,
                          ],
                          "offset": 0,
                          "ringNumber": 2,
                          "size": 5,
                          "substitutions": {
                            "1": "N",
                            "4": "O",
                          },
                          "type": "ring",
                        },
                        {
                          "atoms": [
                            "O",
                          ],
                          "attachments": {},
                          "bonds": [],
                          "type": "linear",
                        },
                      ],
                      "type": "molecule",
                    },
                  ],
                },
                "bonds": [
                  "=",
                  null,
                  "=",
                  null,
                  "=",
                  null,
                ],
                "offset": 0,
                "ringNumber": 1,
                "size": 6,
                "substitutions": {},
                "type": "ring",
              },
              {
                "atoms": [
                  "F",
                ],
                "attachments": {},
                "bonds": [],
                "type": "linear",
              },
            ],
            "type": "molecule",
          },
        ],
        "type": "molecule",
      },
    ],
  },
  "bonds": [
    "=",
    null,
  ],
  "type": "linear",
}
`;

exports[`Linezolid Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C', 'C'], ['=', null]);
export const v2 = Fragment('NC');
export const v3 = Fragment('C1=CC=CC=C1');
export const v4 = Fragment('C2CCCC2');
export const v5 = Fragment('N2CCOC2');
export const v6 = Fragment('COCN');
export const v7 = Linear(['O'], ['=']);
export const v8 = v6.attach(3, v7);
export const v9 = v5.attach(3, v8);
export const v10 = Linear(['O'], [], {}, '=');
export const v11 = Molecule([v9, v10]);
export const v12 = v3.attach(4, v11);
export const v13 = Fragment('F');
export const v14 = Molecule([v12, v13]);
export const v15 = Molecule([v2, v14]);
export const v16 = v1.attach(2, v15);"
`;

exports[`Linezolid Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C', 'C'], ['=', null]);
export const v2 = Linear(['N', 'C']);
export const v3 = Ring({ atoms: 'C', size: 6, bonds: ['=', null, '=', null, '=', null] });
export const v4 = Ring({ atoms: 'C', size: 5, ringNumber: 2 });
export const v5 = v4.substitute(1, 'N');
export const v6 = v5.substitute(4, 'O');
export const v7 = Linear(['C', 'O', 'C', 'N']);
export const v8 = Linear(['O'], ['=']);
export const v9 = v7.attach(3, v8);
export const v10 = v6.attach(3, v9);
export const v11 = Linear(['O'], [], {}, '=');
export const v12 = Molecule([v10, v11]);
export const v13 = v3.attach(4, v12);
export const v14 = Linear(['F']);
export const v15 = Molecule([v13, v14]);
export const v16 = Molecule([v2, v15]);
export const v17 = v1.attach(2, v16);"
`;

exports[`Clindamycin Integration Test parses clindamycin 1`] = `
{
  "atoms": [
    "O",
    "C",
    "C",
    "C",
    "C",
  ],
  "attachments": {
    "2": [
      {
        "components": [
          {
            "atoms": [
              "N",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
          {
            "atoms": "C",
            "attachments": {
              "2": [
                {
                  "atoms": [
                    "O",
                  ],
                  "attachments": {},
                  "bonds": [
                    null,
                  ],
                  "type": "linear",
                },
              ],
              "3": [
                {
                  "components": [
                    {
                      "atoms": [
                        "O",
                      ],
                      "attachments": {},
                      "bonds": [
                        null,
                      ],
                      "type": "linear",
                    },
                    {
                      "components": [
                        {
                          "atoms": "C",
                          "attachments": {
                            "3": [
                              {
                                "atoms": [
                                  "S",
                                  "C",
                                ],
                                "attachments": {},
                                "bonds": [
                                  null,
                                  null,
                                ],
                                "type": "linear",
                              },
                            ],
                            "4": [
                              {
                                "atoms": [
                                  "O",
                                ],
                                "attachments": {},
                                "bonds": [
                                  null,
                                ],
                                "type": "linear",
                              },
                            ],
                            "5": [
                              {
                                "atoms": [
                                  "O",
                                ],
                                "attachments": {},
                                "bonds": [
                                  null,
                                ],
                                "type": "linear",
                              },
                            ],
                          },
                          "bonds": [
                            null,
                            null,
                            null,
                            null,
                            null,
                            null,
                          ],
                          "offset": 0,
                          "ringNumber": 2,
                          "size": 6,
                          "substitutions": {
                            "2": "O",
                          },
                          "type": "ring",
                        },
                        {
                          "atoms": [
                            "N",
                          ],
                          "attachments": {
                            "1": [
                              {
                                "atoms": [
                                  "C",
                                ],
                                "attachments": {},
                                "bonds": [
                                  null,
                                ],
                                "type": "linear",
                              },
                            ],
                          },
                          "bonds": [],
                          "type": "linear",
                        },
                      ],
                      "type": "molecule",
                    },
                    {
                      "atoms": [
                        "C",
                      ],
                      "attachments": {},
                      "bonds": [],
                      "type": "linear",
                    },
                  ],
                  "type": "molecule",
                },
              ],
              "4": [
                {
                  "atoms": [
                    "Cl",
                  ],
                  "attachments": {},
                  "bonds": [
                    null,
                  ],
                  "type": "linear",
                },
              ],
            },
            "bonds": [
              null,
              null,
              null,
              null,
              null,
              null,
            ],
            "offset": 0,
            "ringNumber": 1,
            "size": 6,
            "substitutions": {
              "6": "S",
            },
            "type": "ring",
          },
        ],
        "type": "molecule",
      },
    ],
    "3": [
      {
        "atoms": [
          "C",
          "C",
        ],
        "attachments": {},
        "bonds": [
          null,
          null,
        ],
        "type": "linear",
      },
    ],
  },
  "bonds": [
    "=",
    null,
    null,
    null,
  ],
  "type": "linear",
}
`;

exports[`Clindamycin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C', 'C', 'C', 'C'], ['=', null, null, null]);
export const v2 = Fragment('N');
export const v3 = Fragment('C1CCCCC1');
export const v4 = Fragment('C1CCCCS1');
export const v5 = Fragment('O');
export const v6 = v4.attach(2, v5);
export const v7 = Fragment('O');
export const v8 = Fragment('C2CCCCC2');
export const v9 = Fragment('C2OCCCC2');
export const v10 = Fragment('SC');
export const v11 = v9.attach(3, v10);
export const v12 = Fragment('O');
export const v13 = v11.attach(4, v12);
export const v14 = Fragment('O');
export const v15 = v13.attach(5, v14);
export const v16 = Fragment('N');
export const v17 = Fragment('C');
export const v18 = v16.attach(1, v17);
export const v19 = Molecule([v15, v18]);
export const v20 = Fragment('C');
export const v21 = Molecule([v7, v19, v20]);
export const v22 = v6.attach(3, v21);
export const v23 = Fragment('Cl');
export const v24 = v22.attach(4, v23);
export const v25 = Molecule([v2, v24]);
export const v26 = v1.attach(2, v25);
export const v27 = Fragment('CC');
export const v28 = v26.attach(3, v27);"
`;

exports[`Clindamycin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['O', 'C', 'C', 'C', 'C'], ['=', null, null, null]);
export const v2 = Linear(['N']);
export const v3 = Ring({ atoms: 'C', size: 6 });
export const v4 = v3.substitute(6, 'S');
export const v5 = Linear(['O']);
export const v6 = v4.attach(2, v5);
export const v7 = Linear(['O']);
export const v8 = Ring({ atoms: 'C', size: 6, ringNumber: 2 });
export const v9 = v8.substitute(2, 'O');
export const v10 = Linear(['S', 'C']);
export const v11 = v9.attach(3, v10);
export const v12 = Linear(['O']);
export const v13 = v11.attach(4, v12);
export const v14 = Linear(['O']);
export const v15 = v13.attach(5, v14);
export const v16 = Linear(['N']);
export const v17 = Linear(['C']);
export const v18 = v16.attach(1, v17);
export const v19 = Molecule([v15, v18]);
export const v20 = Linear(['C']);
export const v21 = Molecule([v7, v19, v20]);
export const v22 = v6.attach(3, v21);
export const v23 = Linear(['Cl']);
export const v24 = v22.attach(4, v23);
export const v25 = Molecule([v2, v24]);
export const v26 = v1.attach(2, v25);
export const v27 = Linear(['C', 'C']);
export const v28 = v26.attach(3, v27);"
`;

exports[`Rifampicin Integration Test parses rifampicin 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {},
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "5": [
              {
                "atoms": [
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "6": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            "=",
            "=",
            null,
            "=",
            null,
            "=",
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 7,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            "=",
            null,
          ],
          "offset": 1,
          "ringNumber": 2,
          "size": 6,
          "substitutions": {
            "2": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "4": [
              {
                "atoms": [
                  "O",
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            "=",
            null,
            null,
            "=",
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 3,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "O",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
      ],
      "attachments": {
        "11": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "12": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "13": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "14": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "2": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        "=",
        null,
        "=",
        null,
        "=",
        null,
        "=",
        null,
        null,
        null,
        null,
      ],
      "type": "linear",
    },
    {
      "atoms": "C",
      "attachments": {
        "1": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "4": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 5,
      "substitutions": {
        "2": "O",
        "5": "N",
      },
      "type": "ring",
    },
  ],
  "type": "molecule",
}
`;

exports[`Rifampicin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CO');
export const v2 = Fragment('C1=C=CC=CC=C1');
export const v3 = Fragment('C');
export const v4 = v2.attach(5, v3);
export const v5 = Fragment('O');
export const v6 = v4.attach(6, v5);
export const v7 = Ring({ atoms: 'C', size: 6, ringNumber: 2, offset: 1, bonds: [null, null, null, null, '=', null], leadingBond: '=' });
export const v8 = v7.substitute(2, 'N');
export const v9 = Linear(['O'], ['=']);
export const v10 = v8.attach(3, v9);
export const v11 = Fragment('C3=CCC=CC3');
export const v12 = Linear(['O'], ['=']);
export const v13 = v11.attach(3, v12);
export const v14 = Fragment('OC');
export const v15 = v13.attach(4, v14);
export const v16 = FusedRing({ metadata: { rings: [{ ring: v6, start: 2, end: 22, atoms: [{ position: 2, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'C', bond: '=', rings: [2, 2, 1] }, { position: 16, depth: 0, value: 'C', bond: '=', rings: [2, 1] }, { position: 17, depth: 0, value: 'C', rings: [1] }, { position: 18, depth: 0, value: 'C', bond: '=', rings: [1] }, { position: 20, depth: 0, value: 'C', rings: [1] }, { position: 22, depth: 0, value: 'C', bond: '=', rings: [1] }] }, { ring: v10, start: 3, end: 16, atoms: [{ position: 3, depth: 0, value: 'C', bond: '=', rings: [2, 2, 1] }, { position: 4, depth: 0, value: 'N', rings: [2] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 7, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 15, depth: 0, value: 'C', rings: [3, 2] }, { position: 16, depth: 0, value: 'C', bond: '=', rings: [2, 1] }] }, { ring: v15, start: 7, end: 15, atoms: [{ position: 7, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 8, depth: 0, value: 'C', bond: '=', rings: [3] }, { position: 9, depth: 0, value: 'C', rings: [3] }, { position: 11, depth: 0, value: 'C', rings: [3] }, { position: 14, depth: 0, value: 'C', bond: '=', rings: [3] }, { position: 15, depth: 0, value: 'C', rings: [3, 2] }] }] } });
export const v17 = Linear(['O', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C'], [null, null, '=', null, '=', null, '=', null, '=', null, null, null, null]);
export const v18 = Linear(['O'], ['=']);
export const v19 = v17.attach(2, v18);
export const v20 = Fragment('C');
export const v21 = v19.attach(11, v20);
export const v22 = Fragment('O');
export const v23 = v21.attach(12, v22);
export const v24 = Fragment('C');
export const v25 = v23.attach(13, v24);
export const v26 = Fragment('O');
export const v27 = v25.attach(14, v26);
export const v28 = Fragment('C1CCCC1');
export const v29 = Fragment('C1OCCN1');
export const v30 = Fragment('C');
export const v31 = v29.attach(1, v30);
export const v32 = Linear(['O'], ['=']);
export const v33 = v31.attach(4, v32);
export const v34 = Molecule([v1, v16, v27, v33]);"
`;

exports[`Rifampicin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'O']);
export const v2 = Ring({ atoms: 'C', size: 7, bonds: ['=', '=', null, '=', null, '=', null] });
export const v3 = Linear(['C']);
export const v4 = v2.attach(5, v3);
export const v5 = Linear(['O']);
export const v6 = v4.attach(6, v5);
export const v7 = Ring({ atoms: 'C', size: 6, ringNumber: 2, offset: 1, bonds: [null, null, null, null, '=', null], leadingBond: '=' });
export const v8 = v7.substitute(2, 'N');
export const v9 = Linear(['O'], ['=']);
export const v10 = v8.attach(3, v9);
export const v11 = Ring({ atoms: 'C', size: 6, ringNumber: 3, bonds: ['=', null, null, '=', null, null] });
export const v12 = Linear(['O'], ['=']);
export const v13 = v11.attach(3, v12);
export const v14 = Linear(['O', 'C']);
export const v15 = v13.attach(4, v14);
export const v16 = FusedRing({ metadata: { rings: [{ ring: v6, start: 2, end: 22, atoms: [{ position: 2, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'C', bond: '=', rings: [2, 2, 1] }, { position: 16, depth: 0, value: 'C', bond: '=', rings: [2, 1] }, { position: 17, depth: 0, value: 'C', rings: [1] }, { position: 18, depth: 0, value: 'C', bond: '=', rings: [1] }, { position: 20, depth: 0, value: 'C', rings: [1] }, { position: 22, depth: 0, value: 'C', bond: '=', rings: [1] }] }, { ring: v10, start: 3, end: 16, atoms: [{ position: 3, depth: 0, value: 'C', bond: '=', rings: [2, 2, 1] }, { position: 4, depth: 0, value: 'N', rings: [2] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 7, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 15, depth: 0, value: 'C', rings: [3, 2] }, { position: 16, depth: 0, value: 'C', bond: '=', rings: [2, 1] }] }, { ring: v15, start: 7, end: 15, atoms: [{ position: 7, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 8, depth: 0, value: 'C', bond: '=', rings: [3] }, { position: 9, depth: 0, value: 'C', rings: [3] }, { position: 11, depth: 0, value: 'C', rings: [3] }, { position: 14, depth: 0, value: 'C', bond: '=', rings: [3] }, { position: 15, depth: 0, value: 'C', rings: [3, 2] }] }] } });
export const v17 = Linear(['O', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C'], [null, null, '=', null, '=', null, '=', null, '=', null, null, null, null]);
export const v18 = Linear(['O'], ['=']);
export const v19 = v17.attach(2, v18);
export const v20 = Linear(['C']);
export const v21 = v19.attach(11, v20);
export const v22 = Linear(['O']);
export const v23 = v21.attach(12, v22);
export const v24 = Linear(['C']);
export const v25 = v23.attach(13, v24);
export const v26 = Linear(['O']);
export const v27 = v25.attach(14, v26);
export const v28 = Ring({ atoms: 'C', size: 5 });
export const v29 = v28.substitute(2, 'O');
export const v30 = v29.substitute(5, 'N');
export const v31 = Linear(['C']);
export const v32 = v30.attach(1, v31);
export const v33 = Linear(['O'], ['=']);
export const v34 = v32.attach(4, v33);
export const v35 = Molecule([v1, v16, v27, v34]);"
`;

exports[`Isoniazid Integration Test parses isoniazid 1`] = `
{
  "components": [
    {
      "atoms": [
        "N",
        "N",
        "C",
      ],
      "attachments": {
        "3": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
      ],
      "type": "linear",
    },
    {
      "atoms": "c",
      "attachments": {},
      "bonds": [
        null,
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 6,
      "substitutions": {
        "4": "n",
      },
      "type": "ring",
    },
  ],
  "type": "molecule",
}
`;

exports[`Isoniazid Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('NNC');
export const v2 = Linear(['O'], ['=']);
export const v3 = v1.attach(3, v2);
export const v4 = Fragment('c1ccccc1');
export const v5 = Fragment('c1ccncc1');
export const v6 = Molecule([v3, v5]);"
`;

exports[`Isoniazid Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['N', 'N', 'C']);
export const v2 = Linear(['O'], ['=']);
export const v3 = v1.attach(3, v2);
export const v4 = Ring({ atoms: 'c', size: 6 });
export const v5 = v4.substitute(4, 'n');
export const v6 = Molecule([v3, v5]);"
`;

exports[`Nitrofurantoin Integration Test parses nitrofurantoin 1`] = `
{
  "components": [
    {
      "atoms": [
        "O",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "atoms": "C",
      "attachments": {},
      "bonds": [
        null,
        null,
        "=",
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 5,
      "substitutions": {
        "3": "N",
        "4": "N",
      },
      "type": "ring",
    },
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "atoms": "c",
      "attachments": {
        "4": [
          {
            "atoms": [
              "[N+]",
              "[O-]",
            ],
            "attachments": {
              "1": [
                {
                  "atoms": [
                    "O",
                  ],
                  "attachments": {},
                  "bonds": [
                    "=",
                  ],
                  "type": "linear",
                },
              ],
            },
            "bonds": [
              null,
              null,
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 5,
      "substitutions": {
        "5": "o",
      },
      "type": "ring",
    },
  ],
  "type": "molecule",
}
`;

exports[`Nitrofurantoin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('O');
export const v2 = Fragment('C1CC=CC1');
export const v3 = Fragment('C1CN=NC1');
export const v4 = Linear(['C'], [], {}, '=');
export const v5 = Fragment('c1cccc1');
export const v6 = Fragment('c1ccco1');
export const v7 = Fragment('[N+][O-]');
export const v8 = Linear(['O'], ['=']);
export const v9 = v7.attach(1, v8);
export const v10 = v6.attach(4, v9);
export const v11 = Molecule([v1, v3, v4, v10]);"
`;

exports[`Nitrofurantoin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['O']);
export const v2 = Ring({ atoms: 'C', size: 5, bonds: [null, null, '=', null, null] });
export const v3 = v2.substitute(3, 'N');
export const v4 = v3.substitute(4, 'N');
export const v5 = Linear(['C'], [], {}, '=');
export const v6 = Ring({ atoms: 'c', size: 5 });
export const v7 = v6.substitute(5, 'o');
export const v8 = Linear(['[N+]', '[O-]']);
export const v9 = Linear(['O'], ['=']);
export const v10 = v8.attach(1, v9);
export const v11 = v7.attach(4, v10);
export const v12 = Molecule([v1, v4, v5, v11]);"
`;

exports[`Meropenem Integration Test parses meropenem 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
      ],
      "attachments": {},
      "bonds": [],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {},
          "bonds": [
            null,
            null,
            null,
            "=",
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 5,
          "substitutions": {
            "3": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "components": [
                  {
                    "atoms": [
                      "S",
                    ],
                    "attachments": {},
                    "bonds": [
                      null,
                    ],
                    "type": "linear",
                  },
                  {
                    "rings": [
                      {
                        "atoms": "C",
                        "attachments": {},
                        "bonds": [
                          null,
                          null,
                          null,
                          null,
                          null,
                        ],
                        "offset": 0,
                        "ringNumber": 3,
                        "size": 5,
                        "substitutions": {
                          "3": "N",
                        },
                        "type": "ring",
                      },
                      {
                        "atoms": "C",
                        "attachments": {},
                        "bonds": [
                          null,
                          null,
                          null,
                          null,
                          null,
                        ],
                        "offset": 2,
                        "ringNumber": 4,
                        "size": 5,
                        "substitutions": {
                          "1": "N",
                        },
                        "type": "ring",
                      },
                    ],
                    "type": "fused_ring",
                  },
                ],
                "type": "molecule",
              },
            ],
            "4": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            null,
          ],
          "offset": 1,
          "ringNumber": 2,
          "size": 5,
          "substitutions": {
            "5": "N",
          },
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {
        "1": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
      ],
      "type": "linear",
    },
  ],
  "type": "molecule",
}
`;

exports[`Meropenem Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('C');
export const v2 = Fragment('C1CCC(=C1)');
export const v3 = Fragment('C1CNC(=C1)');
export const v4 = Fragment('C2CCCC2');
export const v5 = Fragment('C2CCCN2');
export const v6 = Fragment('S');
export const v7 = Fragment('C3CCCC3');
export const v8 = Fragment('C3CNCC3');
export const v9 = Fragment('C4CCCC4');
export const v10 = Fragment('N4CCCC4');
export const v11 = Linear(['O'], ['=']);
export const v12 = Linear(['C'], ['=']);
export const v13 = FusedRing({ metadata: { rings: [{ ring: v8, start: 6, end: 13, atoms: [{ position: 6, depth: 1, value: 'C', rings: [3, 3], branchId: 7 }, { position: 7, depth: 1, value: 'C', rings: [3], branchId: 7 }, { position: 8, depth: 1, value: 'N', rings: [4, 4, 3], branchId: 7 }, { position: 12, depth: 1, value: 'C', rings: [4, 3], branchId: 7 }, { position: 13, depth: 1, value: 'C', rings: [3], branchId: 7 }] }, { ring: v10, start: 8, end: 12, atoms: [{ position: 8, depth: 1, value: 'N', rings: [4, 4, 3], branchId: 7 }, { position: 9, depth: 1, value: 'C', rings: [4], branchId: 7 }, { position: 10, depth: 1, value: 'C', rings: [4], branchId: 7 }, { position: 11, depth: 1, value: 'C', rings: [4], branchId: 7 }, { position: 12, depth: 1, value: 'C', rings: [4, 3], branchId: 7 }] }], atoms: [{ position: 14, depth: 1, value: 'N', branchId: 7 }, { position: 15, depth: 1, value: 'C', branchId: 7, attachments: [v11] }, { position: 17, depth: 1, value: 'C', branchId: 7, attachments: [v12] }, { position: 19, depth: 1, value: 'N', branchId: 7 }] } });
export const v14 = Molecule([v6, v13]);
export const v15 = v5.attach(3, v14);
export const v16 = Linear(['O'], ['=']);
export const v17 = v15.attach(4, v16);
export const v18 = FusedRing({ metadata: { rings: [{ ring: v3, start: 1, end: 24, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 2, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 22, depth: 0, value: 'N', rings: [2, 1] }, { position: 23, depth: 0, value: 'C', rings: [1] }, { position: 24, depth: 1, value: 'C', bond: '=', rings: [1], branchId: 42 }] }, { ring: v17, start: 2, end: 22, atoms: [{ position: 2, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 3, depth: 0, value: 'C', rings: [2] }, { position: 4, depth: 0, value: 'C', rings: [2] }, { position: 20, depth: 0, value: 'C', rings: [2] }, { position: 22, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v19 = Fragment('CO');
export const v20 = Linear(['O'], ['=']);
export const v21 = v19.attach(1, v20);
export const v22 = Molecule([v1, v18, v21]);"
`;

exports[`Meropenem Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C']);
export const v2 = Ring({ atoms: 'C', size: 5, bonds: [null, null, null, '=', null], branchDepths: [0, 0, 0, 0, 1] });
export const v3 = v2.substitute(3, 'N');
export const v4 = Ring({ atoms: 'C', size: 5, ringNumber: 2, offset: 1 });
export const v5 = v4.substitute(5, 'N');
export const v6 = Linear(['S']);
export const v7 = Ring({ atoms: 'C', size: 5, ringNumber: 3 });
export const v8 = v7.substitute(3, 'N');
export const v9 = Ring({ atoms: 'C', size: 5, ringNumber: 4, offset: 2 });
export const v10 = v9.substitute(1, 'N');
export const v11 = Linear(['O'], ['=']);
export const v12 = Linear(['C'], ['=']);
export const v13 = FusedRing({ metadata: { rings: [{ ring: v8, start: 6, end: 13, atoms: [{ position: 6, depth: 1, value: 'C', rings: [3, 3], branchId: 7 }, { position: 7, depth: 1, value: 'C', rings: [3], branchId: 7 }, { position: 8, depth: 1, value: 'N', rings: [4, 4, 3], branchId: 7 }, { position: 12, depth: 1, value: 'C', rings: [4, 3], branchId: 7 }, { position: 13, depth: 1, value: 'C', rings: [3], branchId: 7 }] }, { ring: v10, start: 8, end: 12, atoms: [{ position: 8, depth: 1, value: 'N', rings: [4, 4, 3], branchId: 7 }, { position: 9, depth: 1, value: 'C', rings: [4], branchId: 7 }, { position: 10, depth: 1, value: 'C', rings: [4], branchId: 7 }, { position: 11, depth: 1, value: 'C', rings: [4], branchId: 7 }, { position: 12, depth: 1, value: 'C', rings: [4, 3], branchId: 7 }] }], atoms: [{ position: 14, depth: 1, value: 'N', branchId: 7 }, { position: 15, depth: 1, value: 'C', branchId: 7, attachments: [v11] }, { position: 17, depth: 1, value: 'C', branchId: 7, attachments: [v12] }, { position: 19, depth: 1, value: 'N', branchId: 7 }] } });
export const v14 = Molecule([v6, v13]);
export const v15 = v5.attach(3, v14);
export const v16 = Linear(['O'], ['=']);
export const v17 = v15.attach(4, v16);
export const v18 = FusedRing({ metadata: { rings: [{ ring: v3, start: 1, end: 24, atoms: [{ position: 1, depth: 0, value: 'C', rings: [1, 1] }, { position: 2, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 22, depth: 0, value: 'N', rings: [2, 1] }, { position: 23, depth: 0, value: 'C', rings: [1] }, { position: 24, depth: 1, value: 'C', bond: '=', rings: [1], branchId: 42 }] }, { ring: v17, start: 2, end: 22, atoms: [{ position: 2, depth: 0, value: 'C', rings: [2, 2, 1] }, { position: 3, depth: 0, value: 'C', rings: [2] }, { position: 4, depth: 0, value: 'C', rings: [2] }, { position: 20, depth: 0, value: 'C', rings: [2] }, { position: 22, depth: 0, value: 'N', rings: [2, 1] }] }] } });
export const v19 = Linear(['C', 'O']);
export const v20 = Linear(['O'], ['=']);
export const v21 = v19.attach(1, v20);
export const v22 = Molecule([v1, v18, v21]);"
`;

exports[`Daptomycin Integration Test parses daptomycin 1`] = `
{
  "atoms": [
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "N",
    "C",
    "C",
    "N",
    "C",
    "C",
    "N",
    "C",
    "C",
    "N",
    "C",
    "C",
    "N",
    "C",
    "C",
    "N",
    "C",
    "C",
    "O",
  ],
  "attachments": {
    "10": [
      {
        "atoms": [
          "O",
        ],
        "attachments": {},
        "bonds": [
          "=",
        ],
        "type": "linear",
      },
    ],
    "12": [
      {
        "atoms": [
          "C",
          "C",
          "O",
        ],
        "attachments": {
          "2": [
            {
              "atoms": [
                "N",
              ],
              "attachments": {},
              "bonds": [
                null,
              ],
              "type": "linear",
            },
          ],
        },
        "bonds": [
          null,
          null,
          "=",
        ],
        "type": "linear",
      },
    ],
    "13": [
      {
        "atoms": [
          "O",
        ],
        "attachments": {},
        "bonds": [
          "=",
        ],
        "type": "linear",
      },
    ],
    "15": [
      {
        "atoms": [
          "C",
          "C",
          "O",
        ],
        "attachments": {
          "2": [
            {
              "atoms": [
                "O",
              ],
              "attachments": {},
              "bonds": [
                null,
              ],
              "type": "linear",
            },
          ],
        },
        "bonds": [
          null,
          null,
          "=",
        ],
        "type": "linear",
      },
    ],
    "16": [
      {
        "atoms": [
          "O",
        ],
        "attachments": {},
        "bonds": [
          "=",
        ],
        "type": "linear",
      },
    ],
    "18": [
      {
        "components": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
          {
            "atoms": "c",
            "attachments": {},
            "bonds": [
              null,
              null,
              null,
              null,
              null,
              null,
            ],
            "offset": 0,
            "ringNumber": 1,
            "size": 6,
            "substitutions": {},
            "type": "ring",
          },
        ],
        "type": "molecule",
      },
    ],
    "19": [
      {
        "atoms": [
          "O",
        ],
        "attachments": {},
        "bonds": [
          "=",
        ],
        "type": "linear",
      },
    ],
    "21": [
      {
        "atoms": [
          "C",
          "C",
          "O",
        ],
        "attachments": {
          "2": [
            {
              "atoms": [
                "N",
              ],
              "attachments": {},
              "bonds": [
                null,
              ],
              "type": "linear",
            },
          ],
        },
        "bonds": [
          null,
          null,
          "=",
        ],
        "type": "linear",
      },
    ],
    "22": [
      {
        "atoms": [
          "O",
        ],
        "attachments": {},
        "bonds": [
          "=",
        ],
        "type": "linear",
      },
    ],
    "24": [
      {
        "atoms": [
          "C",
          "C",
          "O",
        ],
        "attachments": {
          "2": [
            {
              "atoms": [
                "O",
              ],
              "attachments": {},
              "bonds": [
                null,
              ],
              "type": "linear",
            },
          ],
        },
        "bonds": [
          null,
          null,
          "=",
        ],
        "type": "linear",
      },
    ],
    "25": [
      {
        "atoms": [
          "O",
        ],
        "attachments": {},
        "bonds": [
          "=",
        ],
        "type": "linear",
      },
    ],
    "27": [
      {
        "atoms": [
          "C",
          "O",
        ],
        "attachments": {},
        "bonds": [
          null,
          null,
        ],
        "type": "linear",
      },
    ],
    "28": [
      {
        "atoms": [
          "O",
        ],
        "attachments": {},
        "bonds": [
          "=",
        ],
        "type": "linear",
      },
    ],
  },
  "bonds": [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
  ],
  "type": "linear",
}
`;

exports[`Daptomycin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CCCCCCCCCCNCCNCCNCCNCCNCCNCCO');
export const v2 = Linear(['O'], ['=']);
export const v3 = v1.attach(10, v2);
export const v4 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v5 = Fragment('N');
export const v6 = v4.attach(2, v5);
export const v7 = v3.attach(12, v6);
export const v8 = Linear(['O'], ['=']);
export const v9 = v7.attach(13, v8);
export const v10 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v11 = Fragment('O');
export const v12 = v10.attach(2, v11);
export const v13 = v9.attach(15, v12);
export const v14 = Linear(['O'], ['=']);
export const v15 = v13.attach(16, v14);
export const v16 = Fragment('C');
export const v17 = Fragment('c1ccccc1');
export const v18 = Molecule([v16, v17]);
export const v19 = v15.attach(18, v18);
export const v20 = Linear(['O'], ['=']);
export const v21 = v19.attach(19, v20);
export const v22 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v23 = Fragment('N');
export const v24 = v22.attach(2, v23);
export const v25 = v21.attach(21, v24);
export const v26 = Linear(['O'], ['=']);
export const v27 = v25.attach(22, v26);
export const v28 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v29 = Fragment('O');
export const v30 = v28.attach(2, v29);
export const v31 = v27.attach(24, v30);
export const v32 = Linear(['O'], ['=']);
export const v33 = v31.attach(25, v32);
export const v34 = Fragment('CO');
export const v35 = v33.attach(27, v34);
export const v36 = Linear(['O'], ['=']);
export const v37 = v35.attach(28, v36);"
`;

exports[`Daptomycin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'N', 'C', 'C', 'N', 'C', 'C', 'N', 'C', 'C', 'N', 'C', 'C', 'N', 'C', 'C', 'N', 'C', 'C', 'O']);
export const v2 = Linear(['O'], ['=']);
export const v3 = v1.attach(10, v2);
export const v4 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v5 = Linear(['N']);
export const v6 = v4.attach(2, v5);
export const v7 = v3.attach(12, v6);
export const v8 = Linear(['O'], ['=']);
export const v9 = v7.attach(13, v8);
export const v10 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v11 = Linear(['O']);
export const v12 = v10.attach(2, v11);
export const v13 = v9.attach(15, v12);
export const v14 = Linear(['O'], ['=']);
export const v15 = v13.attach(16, v14);
export const v16 = Linear(['C']);
export const v17 = Ring({ atoms: 'c', size: 6 });
export const v18 = Molecule([v16, v17]);
export const v19 = v15.attach(18, v18);
export const v20 = Linear(['O'], ['=']);
export const v21 = v19.attach(19, v20);
export const v22 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v23 = Linear(['N']);
export const v24 = v22.attach(2, v23);
export const v25 = v21.attach(21, v24);
export const v26 = Linear(['O'], ['=']);
export const v27 = v25.attach(22, v26);
export const v28 = Linear(['C', 'C', 'O'], [null, null, '=']);
export const v29 = Linear(['O']);
export const v30 = v28.attach(2, v29);
export const v31 = v27.attach(24, v30);
export const v32 = Linear(['O'], ['=']);
export const v33 = v31.attach(25, v32);
export const v34 = Linear(['C', 'O']);
export const v35 = v33.attach(27, v34);
export const v36 = Linear(['O'], ['=']);
export const v37 = v35.attach(28, v36);"
`;

exports[`Rifampin Integration Test parses rifampin (alias for rifampicin) 1`] = `
{
  "components": [
    {
      "atoms": [
        "C",
        "O",
      ],
      "attachments": {},
      "bonds": [
        null,
      ],
      "type": "linear",
    },
    {
      "rings": [
        {
          "atoms": "C",
          "attachments": {
            "5": [
              {
                "atoms": [
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
            "6": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            "=",
            "=",
            null,
            "=",
            null,
            "=",
            null,
          ],
          "offset": 0,
          "ringNumber": 1,
          "size": 7,
          "substitutions": {},
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            null,
            null,
            null,
            null,
            "=",
            null,
          ],
          "offset": 1,
          "ringNumber": 2,
          "size": 6,
          "substitutions": {
            "2": "N",
          },
          "type": "ring",
        },
        {
          "atoms": "C",
          "attachments": {
            "3": [
              {
                "atoms": [
                  "O",
                ],
                "attachments": {},
                "bonds": [
                  "=",
                ],
                "type": "linear",
              },
            ],
            "4": [
              {
                "atoms": [
                  "O",
                  "C",
                ],
                "attachments": {},
                "bonds": [
                  null,
                  null,
                ],
                "type": "linear",
              },
            ],
          },
          "bonds": [
            "=",
            null,
            null,
            "=",
            null,
            null,
          ],
          "offset": 0,
          "ringNumber": 3,
          "size": 6,
          "substitutions": {},
          "type": "ring",
        },
      ],
      "type": "fused_ring",
    },
    {
      "atoms": [
        "O",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
        "C",
      ],
      "attachments": {
        "11": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "12": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "13": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "14": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "2": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        "=",
        null,
        "=",
        null,
        "=",
        null,
        "=",
        null,
        null,
        null,
        null,
      ],
      "type": "linear",
    },
    {
      "atoms": "C",
      "attachments": {
        "1": [
          {
            "atoms": [
              "C",
            ],
            "attachments": {},
            "bonds": [
              null,
            ],
            "type": "linear",
          },
        ],
        "4": [
          {
            "atoms": [
              "O",
            ],
            "attachments": {},
            "bonds": [
              "=",
            ],
            "type": "linear",
          },
        ],
      },
      "bonds": [
        null,
        null,
        null,
        null,
        null,
      ],
      "offset": 0,
      "ringNumber": 1,
      "size": 5,
      "substitutions": {
        "2": "O",
        "5": "N",
      },
      "type": "ring",
    },
  ],
  "type": "molecule",
}
`;

exports[`Rifampin Integration Test generates valid code via toCode() 1`] = `
"export const v1 = Fragment('CO');
export const v2 = Fragment('C1=C=CC=CC=C1');
export const v3 = Fragment('C');
export const v4 = v2.attach(5, v3);
export const v5 = Fragment('O');
export const v6 = v4.attach(6, v5);
export const v7 = Ring({ atoms: 'C', size: 6, ringNumber: 2, offset: 1, bonds: [null, null, null, null, '=', null], leadingBond: '=' });
export const v8 = v7.substitute(2, 'N');
export const v9 = Linear(['O'], ['=']);
export const v10 = v8.attach(3, v9);
export const v11 = Fragment('C3=CCC=CC3');
export const v12 = Linear(['O'], ['=']);
export const v13 = v11.attach(3, v12);
export const v14 = Fragment('OC');
export const v15 = v13.attach(4, v14);
export const v16 = FusedRing({ metadata: { rings: [{ ring: v6, start: 2, end: 22, atoms: [{ position: 2, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'C', bond: '=', rings: [2, 2, 1] }, { position: 16, depth: 0, value: 'C', bond: '=', rings: [2, 1] }, { position: 17, depth: 0, value: 'C', rings: [1] }, { position: 18, depth: 0, value: 'C', bond: '=', rings: [1] }, { position: 20, depth: 0, value: 'C', rings: [1] }, { position: 22, depth: 0, value: 'C', bond: '=', rings: [1] }] }, { ring: v10, start: 3, end: 16, atoms: [{ position: 3, depth: 0, value: 'C', bond: '=', rings: [2, 2, 1] }, { position: 4, depth: 0, value: 'N', rings: [2] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 7, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 15, depth: 0, value: 'C', rings: [3, 2] }, { position: 16, depth: 0, value: 'C', bond: '=', rings: [2, 1] }] }, { ring: v15, start: 7, end: 15, atoms: [{ position: 7, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 8, depth: 0, value: 'C', bond: '=', rings: [3] }, { position: 9, depth: 0, value: 'C', rings: [3] }, { position: 11, depth: 0, value: 'C', rings: [3] }, { position: 14, depth: 0, value: 'C', bond: '=', rings: [3] }, { position: 15, depth: 0, value: 'C', rings: [3, 2] }] }] } });
export const v17 = Linear(['O', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C'], [null, null, '=', null, '=', null, '=', null, '=', null, null, null, null]);
export const v18 = Linear(['O'], ['=']);
export const v19 = v17.attach(2, v18);
export const v20 = Fragment('C');
export const v21 = v19.attach(11, v20);
export const v22 = Fragment('O');
export const v23 = v21.attach(12, v22);
export const v24 = Fragment('C');
export const v25 = v23.attach(13, v24);
export const v26 = Fragment('O');
export const v27 = v25.attach(14, v26);
export const v28 = Fragment('C1CCCC1');
export const v29 = Fragment('C1OCCN1');
export const v30 = Fragment('C');
export const v31 = v29.attach(1, v30);
export const v32 = Linear(['O'], ['=']);
export const v33 = v31.attach(4, v32);
export const v34 = Molecule([v1, v16, v27, v33]);"
`;

exports[`Rifampin Integration Test generates valid verbose code via toCode() 1`] = `
"export const v1 = Linear(['C', 'O']);
export const v2 = Ring({ atoms: 'C', size: 7, bonds: ['=', '=', null, '=', null, '=', null] });
export const v3 = Linear(['C']);
export const v4 = v2.attach(5, v3);
export const v5 = Linear(['O']);
export const v6 = v4.attach(6, v5);
export const v7 = Ring({ atoms: 'C', size: 6, ringNumber: 2, offset: 1, bonds: [null, null, null, null, '=', null], leadingBond: '=' });
export const v8 = v7.substitute(2, 'N');
export const v9 = Linear(['O'], ['=']);
export const v10 = v8.attach(3, v9);
export const v11 = Ring({ atoms: 'C', size: 6, ringNumber: 3, bonds: ['=', null, null, '=', null, null] });
export const v12 = Linear(['O'], ['=']);
export const v13 = v11.attach(3, v12);
export const v14 = Linear(['O', 'C']);
export const v15 = v13.attach(4, v14);
export const v16 = FusedRing({ metadata: { rings: [{ ring: v6, start: 2, end: 22, atoms: [{ position: 2, depth: 0, value: 'C', rings: [1, 1] }, { position: 3, depth: 0, value: 'C', bond: '=', rings: [2, 2, 1] }, { position: 16, depth: 0, value: 'C', bond: '=', rings: [2, 1] }, { position: 17, depth: 0, value: 'C', rings: [1] }, { position: 18, depth: 0, value: 'C', bond: '=', rings: [1] }, { position: 20, depth: 0, value: 'C', rings: [1] }, { position: 22, depth: 0, value: 'C', bond: '=', rings: [1] }] }, { ring: v10, start: 3, end: 16, atoms: [{ position: 3, depth: 0, value: 'C', bond: '=', rings: [2, 2, 1] }, { position: 4, depth: 0, value: 'N', rings: [2] }, { position: 5, depth: 0, value: 'C', rings: [2] }, { position: 7, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 15, depth: 0, value: 'C', rings: [3, 2] }, { position: 16, depth: 0, value: 'C', bond: '=', rings: [2, 1] }] }, { ring: v15, start: 7, end: 15, atoms: [{ position: 7, depth: 0, value: 'C', rings: [3, 3, 2] }, { position: 8, depth: 0, value: 'C', bond: '=', rings: [3] }, { position: 9, depth: 0, value: 'C', rings: [3] }, { position: 11, depth: 0, value: 'C', rings: [3] }, { position: 14, depth: 0, value: 'C', bond: '=', rings: [3] }, { position: 15, depth: 0, value: 'C', rings: [3, 2] }] }] } });
export const v17 = Linear(['O', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C'], [null, null, '=', null, '=', null, '=', null, '=', null, null, null, null]);
export const v18 = Linear(['O'], ['=']);
export const v19 = v17.attach(2, v18);
export const v20 = Linear(['C']);
export const v21 = v19.attach(11, v20);
export const v22 = Linear(['O']);
export const v23 = v21.attach(12, v22);
export const v24 = Linear(['C']);
export const v25 = v23.attach(13, v24);
export const v26 = Linear(['O']);
export const v27 = v25.attach(14, v26);
export const v28 = Ring({ atoms: 'C', size: 5 });
export const v29 = v28.substitute(2, 'O');
export const v30 = v29.substitute(5, 'N');
export const v31 = Linear(['C']);
export const v32 = v30.attach(1, v31);
export const v33 = Linear(['O'], ['=']);
export const v34 = v32.attach(4, v33);
export const v35 = Molecule([v1, v16, v27, v34]);"
`;
